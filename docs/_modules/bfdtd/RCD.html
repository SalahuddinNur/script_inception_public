
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>bfdtd.RCD &#8212; script_inception_public  documentation</title>
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">script_inception_public  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for bfdtd.RCD</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># -*- coding: utf-8 -*-</span>

<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">RCD BFDTD objects</span>

<span class="sd">RCD = Rod Connected Diamond</span>

<span class="sd">.. todo:: Hexagonal layout</span>
<span class="sd">.. todo:: Blender addon</span>
<span class="sd">.. todo:: FCC sphere structure</span>
<span class="sd">.. todo:: general lattice + unit cell system like MPB (with all the 14 3D bravais lattices? or at least BCC/FCC/hex)</span>
<span class="sd">.. todo:: PyQt interface</span>
<span class="sd">.. todo:: Add option to write out unit cells and lattice vectors for easier understanding (part of blender add-on?)</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">tempfile</span>

<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="k">import</span> <span class="n">array</span><span class="p">,</span> <span class="n">sqrt</span>
<span class="kn">from</span> <span class="nn">numpy.linalg</span> <span class="k">import</span> <span class="n">norm</span>

<span class="c1"># .. todo:: simplify to something like import bfdtd in the future. (look up info on good module layout practice)</span>
<span class="kn">from</span> <span class="nn">.BFDTDobject</span> <span class="k">import</span> <span class="n">BFDTDobject</span>
<span class="kn">from</span> <span class="nn">.GeometryObjects</span> <span class="k">import</span> <span class="n">GeometryObject</span><span class="p">,</span> <span class="n">Cylinder</span><span class="p">,</span> <span class="n">Distorted</span><span class="p">,</span> <span class="n">Parallelepiped</span><span class="p">,</span> <span class="n">Sphere</span><span class="p">,</span> <span class="n">Block</span>
<span class="kn">from</span> <span class="nn">.meshobject</span> <span class="k">import</span> <span class="n">MeshObject</span>
<span class="kn">from</span> <span class="nn">.excitation</span> <span class="k">import</span> <span class="n">Excitation</span><span class="p">,</span> <span class="n">ExcitationWithGaussianTemplate</span><span class="p">,</span> <span class="n">ExcitationWithUniformTemplate</span>

<span class="kn">from</span> <span class="nn">meshing.meshing</span> <span class="k">import</span> <span class="n">linspaces</span><span class="p">,</span> <span class="n">HeterogeneousMesh1D</span><span class="p">,</span> <span class="n">HomogeneousMesh1D</span><span class="p">,</span> <span class="n">HomogeneousMeshParameters1D</span><span class="p">,</span> <span class="n">Mesh1D</span><span class="p">,</span> <span class="n">Mesh3D</span><span class="p">,</span> <span class="n">MultiMesh1D</span>

<div class="viewcode-block" id="RCD_HexagonalLattice"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.RCD.RCD_HexagonalLattice">[docs]</a><span class="k">class</span> <span class="nc">RCD_HexagonalLattice</span><span class="p">(</span><span class="n">GeometryObject</span><span class="p">):</span>
  <span class="sd">&#39;&#39;&#39; This class allows you to create RCD structures with some cylinders alligned along the Z axis. &#39;&#39;&#39;</span>

  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; constructor &#39;&#39;&#39;</span>
    <span class="n">GeometryObject</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">inner_radius</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">outer_radius</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cubic_unit_cell_size</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">geo_list</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">unit_cell_index_list</span> <span class="o">=</span> <span class="kc">None</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">unit_cell_type</span> <span class="o">=</span> <span class="mi">1</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">shifted</span> <span class="o">=</span> <span class="kc">False</span>
    
    <span class="c1"># quick and dirty, but so that DH can do more crazy things until we find a better solution...</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_spheres</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">use_cylinders</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">add_bottom_sphere</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">relative_sphere_radius</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">relative_sphere_index</span> <span class="o">=</span> <span class="mi">1</span>
    
    <span class="c1"># The tetrahedron centres</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__R0__</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span>   <span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span>     <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__R1__</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span>   <span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span>     <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__R2__</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span>         <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">24</span><span class="p">),</span>     <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">])</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">__G0__</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span>           <span class="mi">0</span><span class="p">,</span>  <span class="mi">7</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">12</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__G1__</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span>         <span class="mi">0</span><span class="p">,</span>   <span class="n">sqrt</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span>  <span class="mi">7</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">12</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__G2__</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span>           <span class="mi">0</span><span class="p">,</span>  <span class="mi">7</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">12</span><span class="p">])</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">__B0__</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span>  <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="mi">11</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">12</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__B1__</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span>         <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">24</span><span class="p">),</span> <span class="mi">11</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">12</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__B2__</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span>  <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="mi">11</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">12</span><span class="p">])</span>
    
    <span class="c1"># cell type 1 parameters</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__offset1__</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">24</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__u1__</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__v1__</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span>  <span class="n">sqrt</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__w1__</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)])</span>

    <span class="c1"># cell type 2 parameters</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__offset2__</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">24</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__u2__</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__v2__</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__w2__</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)])</span>

<div class="viewcode-block" id="RCD_HexagonalLattice.setShifted"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.RCD.RCD_HexagonalLattice.setShifted">[docs]</a>  <span class="k">def</span> <span class="nf">setShifted</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shifted</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">shifted</span> <span class="o">=</span> <span class="n">shifted</span>
    <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shifted</span><span class="p">)</span></div>

<div class="viewcode-block" id="RCD_HexagonalLattice.setOuterRadius"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.RCD.RCD_HexagonalLattice.setOuterRadius">[docs]</a>  <span class="k">def</span> <span class="nf">setOuterRadius</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outer_radius</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; set outer radius of rods &#39;&#39;&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">outer_radius</span> <span class="o">=</span> <span class="n">outer_radius</span>
    <span class="k">return</span></div>

<div class="viewcode-block" id="RCD_HexagonalLattice.getOuterRadius"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.RCD.RCD_HexagonalLattice.getOuterRadius">[docs]</a>  <span class="k">def</span> <span class="nf">getOuterRadius</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; get outer radius of rods &#39;&#39;&#39;</span>
    <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outer_radius</span><span class="p">)</span></div>

<div class="viewcode-block" id="RCD_HexagonalLattice.setLocation"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.RCD.RCD_HexagonalLattice.setLocation">[docs]</a>  <span class="k">def</span> <span class="nf">setLocation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">location</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Set the location of the RCD.</span>
<span class="sd">    </span>
<span class="sd">    .. todo:: Add RCD illustrations.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">location</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>
    <span class="k">return</span></div>

<div class="viewcode-block" id="RCD_HexagonalLattice.setCubicUnitCellSize"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.RCD.RCD_HexagonalLattice.setCubicUnitCellSize">[docs]</a>  <span class="k">def</span> <span class="nf">setCubicUnitCellSize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cubic_unit_cell_size</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cubic_unit_cell_size</span> <span class="o">=</span> <span class="n">cubic_unit_cell_size</span>
    <span class="k">return</span></div>

<div class="viewcode-block" id="RCD_HexagonalLattice.setUnitCellType"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.RCD.RCD_HexagonalLattice.setUnitCellType">[docs]</a>  <span class="k">def</span> <span class="nf">setUnitCellType</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit_cell_type</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">unit_cell_type</span> <span class="o">=</span> <span class="n">unit_cell_type</span>
    <span class="k">return</span></div>

<div class="viewcode-block" id="RCD_HexagonalLattice.getUnitCellType"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.RCD.RCD_HexagonalLattice.getUnitCellType">[docs]</a>  <span class="k">def</span> <span class="nf">getUnitCellType</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unit_cell_type</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="RCD_HexagonalLattice.getLatticeVectors"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.RCD.RCD_HexagonalLattice.getLatticeVectors">[docs]</a>  <span class="k">def</span> <span class="nf">getLatticeVectors</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_cell_type</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
      <span class="k">return</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">cubic_unit_cell_size</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">__u1__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cubic_unit_cell_size</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">__v1__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cubic_unit_cell_size</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">__w1__</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">return</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">cubic_unit_cell_size</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">__u2__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cubic_unit_cell_size</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">__v2__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cubic_unit_cell_size</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">__w2__</span><span class="p">))</span></div>

<div class="viewcode-block" id="RCD_HexagonalLattice.getXMesh"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.RCD.RCD_HexagonalLattice.getXMesh">[docs]</a>  <span class="k">def</span> <span class="nf">getXMesh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Nx</span><span class="p">,</span> <span class="n">Ny</span><span class="p">,</span> <span class="n">Nz</span><span class="p">,</span> <span class="n">NcellsMin</span><span class="p">):</span>
    <span class="n">X_mesh</span> <span class="o">=</span> <span class="n">MultiMesh1D</span><span class="p">()</span>
    
    <span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">w</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLatticeVectors</span><span class="p">()</span>
    <span class="n">RCD_min_x</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">Nx</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">norm</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
    <span class="n">delta</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
    
    <span class="n">cur_min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLocation</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">RCD_min_x</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">Nx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
      <span class="n">m</span> <span class="o">=</span> <span class="n">HomogeneousMeshParameters1D</span><span class="p">(</span><span class="n">cur_min</span><span class="p">,</span> <span class="n">cur_min</span><span class="o">+</span><span class="n">delta</span><span class="p">)</span>
      <span class="n">m</span><span class="o">.</span><span class="n">setNcellsMin</span><span class="p">(</span><span class="n">NcellsMin</span><span class="p">)</span>
      <span class="n">m</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;RCD_X_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
      <span class="c1">#X_mesh.addChild(m)</span>
      <span class="n">X_mesh</span><span class="o">.</span><span class="n">mesh_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
      <span class="n">cur_min</span> <span class="o">=</span> <span class="n">cur_min</span> <span class="o">+</span> <span class="n">delta</span>

    <span class="k">return</span><span class="p">(</span><span class="n">X_mesh</span><span class="p">)</span></div>

<div class="viewcode-block" id="RCD_HexagonalLattice.getYMesh"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.RCD.RCD_HexagonalLattice.getYMesh">[docs]</a>  <span class="k">def</span> <span class="nf">getYMesh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Nx</span><span class="p">,</span> <span class="n">Ny</span><span class="p">,</span> <span class="n">Nz</span><span class="p">,</span> <span class="n">NcellsMin</span><span class="p">):</span>
    <span class="n">Y_mesh</span> <span class="o">=</span> <span class="n">MultiMesh1D</span><span class="p">()</span>
    
    <span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">w</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLatticeVectors</span><span class="p">()</span>
    <span class="n">RCD_min_y</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">Ny</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
    <span class="n">delta</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">/</span><span class="mi">6</span>
    
    <span class="n">cur_min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLocation</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">RCD_min_y</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">Ny</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="o">+</span><span class="mi">2</span><span class="p">):</span>
      <span class="n">m</span> <span class="o">=</span> <span class="n">HomogeneousMeshParameters1D</span><span class="p">(</span><span class="n">cur_min</span><span class="p">,</span> <span class="n">cur_min</span><span class="o">+</span><span class="n">delta</span><span class="p">)</span>
      <span class="n">m</span><span class="o">.</span><span class="n">setNcellsMin</span><span class="p">(</span><span class="n">NcellsMin</span><span class="p">)</span>
      <span class="n">m</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;RCD_Y_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
      <span class="c1">#Y_mesh.addChild(m)</span>
      <span class="n">Y_mesh</span><span class="o">.</span><span class="n">mesh_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
      <span class="n">cur_min</span> <span class="o">=</span> <span class="n">cur_min</span> <span class="o">+</span> <span class="n">delta</span>

    <span class="k">return</span><span class="p">(</span><span class="n">Y_mesh</span><span class="p">)</span></div>

<div class="viewcode-block" id="RCD_HexagonalLattice.getZMesh"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.RCD.RCD_HexagonalLattice.getZMesh">[docs]</a>  <span class="k">def</span> <span class="nf">getZMesh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Nx</span><span class="p">,</span> <span class="n">Ny</span><span class="p">,</span> <span class="n">Nz</span><span class="p">,</span> <span class="n">NcellsMin1</span><span class="p">,</span> <span class="n">NcellsMin2</span><span class="p">):</span>
    <span class="n">Z_mesh</span> <span class="o">=</span> <span class="n">MultiMesh1D</span><span class="p">()</span>
    
    <span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">w</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLatticeVectors</span><span class="p">()</span>
    <span class="n">RCD_min_z</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">Nz</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">norm</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">__offset2__</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">cubic_unit_cell_size</span>
    <span class="n">delta</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">/</span><span class="mi">12</span>
    
    <span class="n">cur_min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLocation</span><span class="p">()[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">RCD_min_z</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">Nz</span><span class="o">-</span><span class="mi">1</span><span class="p">)):</span>
      <span class="n">m</span> <span class="o">=</span> <span class="n">HomogeneousMeshParameters1D</span><span class="p">(</span><span class="n">cur_min</span><span class="p">,</span> <span class="n">cur_min</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">delta</span><span class="p">)</span>
      <span class="n">m</span><span class="o">.</span><span class="n">setNcellsMin</span><span class="p">(</span><span class="n">NcellsMin1</span><span class="p">)</span>
      <span class="n">m</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;RCD_Z_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
      <span class="n">Z_mesh</span><span class="o">.</span><span class="n">mesh_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>

      <span class="n">m</span> <span class="o">=</span> <span class="n">HomogeneousMeshParameters1D</span><span class="p">(</span><span class="n">cur_min</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">delta</span><span class="p">,</span> <span class="n">cur_min</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">delta</span><span class="p">)</span>
      <span class="n">m</span><span class="o">.</span><span class="n">setNcellsMin</span><span class="p">(</span><span class="n">NcellsMin2</span><span class="p">)</span>
      <span class="n">m</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;RCD_Z_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
      <span class="n">Z_mesh</span><span class="o">.</span><span class="n">mesh_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
      
      <span class="n">cur_min</span> <span class="o">=</span> <span class="n">cur_min</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">delta</span>

    <span class="k">return</span><span class="p">(</span><span class="n">Z_mesh</span><span class="p">)</span></div>

<div class="viewcode-block" id="RCD_HexagonalLattice.getXMesh_with_SpacingMax"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.RCD.RCD_HexagonalLattice.getXMesh_with_SpacingMax">[docs]</a>  <span class="k">def</span> <span class="nf">getXMesh_with_SpacingMax</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Nx</span><span class="p">,</span> <span class="n">Ny</span><span class="p">,</span> <span class="n">Nz</span><span class="p">,</span> <span class="n">spacing_max</span><span class="p">):</span>
    <span class="n">X_mesh</span> <span class="o">=</span> <span class="n">MultiMesh1D</span><span class="p">()</span>
    
    <span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">w</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLatticeVectors</span><span class="p">()</span>
    <span class="n">RCD_min_x</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">Nx</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">norm</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
    <span class="n">delta</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span>
    
    <span class="n">cur_min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLocation</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">RCD_min_x</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">Nx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
      <span class="n">m</span> <span class="o">=</span> <span class="n">HomogeneousMeshParameters1D</span><span class="p">(</span><span class="n">cur_min</span><span class="p">,</span> <span class="n">cur_min</span><span class="o">+</span><span class="n">delta</span><span class="p">)</span>
      <span class="n">m</span><span class="o">.</span><span class="n">setSpacingMax</span><span class="p">(</span><span class="n">spacing_max</span><span class="p">)</span>
      <span class="n">m</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;RCD_X_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
      <span class="c1">#X_mesh.addChild(m)</span>
      <span class="n">X_mesh</span><span class="o">.</span><span class="n">mesh_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
      <span class="n">cur_min</span> <span class="o">=</span> <span class="n">cur_min</span> <span class="o">+</span> <span class="n">delta</span>

    <span class="k">return</span><span class="p">(</span><span class="n">X_mesh</span><span class="p">)</span></div>

<div class="viewcode-block" id="RCD_HexagonalLattice.getYMesh_with_SpacingMax"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.RCD.RCD_HexagonalLattice.getYMesh_with_SpacingMax">[docs]</a>  <span class="k">def</span> <span class="nf">getYMesh_with_SpacingMax</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Nx</span><span class="p">,</span> <span class="n">Ny</span><span class="p">,</span> <span class="n">Nz</span><span class="p">,</span> <span class="n">spacing_max</span><span class="p">):</span>
    <span class="n">Y_mesh</span> <span class="o">=</span> <span class="n">MultiMesh1D</span><span class="p">()</span>
    
    <span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">w</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLatticeVectors</span><span class="p">()</span>
    <span class="n">RCD_min_y</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">Ny</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
    <span class="n">delta</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">/</span><span class="mi">6</span>
    
    <span class="n">cur_min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLocation</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">RCD_min_y</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">Ny</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="o">+</span><span class="mi">2</span><span class="p">):</span>
      <span class="n">m</span> <span class="o">=</span> <span class="n">HomogeneousMeshParameters1D</span><span class="p">(</span><span class="n">cur_min</span><span class="p">,</span> <span class="n">cur_min</span><span class="o">+</span><span class="n">delta</span><span class="p">)</span>
      <span class="n">m</span><span class="o">.</span><span class="n">setSpacingMax</span><span class="p">(</span><span class="n">spacing_max</span><span class="p">)</span>
      <span class="n">m</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;RCD_Y_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
      <span class="c1">#Y_mesh.addChild(m)</span>
      <span class="n">Y_mesh</span><span class="o">.</span><span class="n">mesh_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
      <span class="n">cur_min</span> <span class="o">=</span> <span class="n">cur_min</span> <span class="o">+</span> <span class="n">delta</span>

    <span class="k">return</span><span class="p">(</span><span class="n">Y_mesh</span><span class="p">)</span></div>

<div class="viewcode-block" id="RCD_HexagonalLattice.getZMesh_with_SpacingMax"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.RCD.RCD_HexagonalLattice.getZMesh_with_SpacingMax">[docs]</a>  <span class="k">def</span> <span class="nf">getZMesh_with_SpacingMax</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Nx</span><span class="p">,</span> <span class="n">Ny</span><span class="p">,</span> <span class="n">Nz</span><span class="p">,</span> <span class="n">spacing_max</span><span class="p">):</span>
    <span class="n">Z_mesh</span> <span class="o">=</span> <span class="n">MultiMesh1D</span><span class="p">()</span>
    
    <span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">w</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLatticeVectors</span><span class="p">()</span>
    <span class="n">RCD_min_z</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">Nz</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">norm</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">__offset2__</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">cubic_unit_cell_size</span>
    <span class="n">delta</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">/</span><span class="mi">12</span>
    
    <span class="n">cur_min</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLocation</span><span class="p">()[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">RCD_min_z</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">12</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">Nz</span><span class="o">-</span><span class="mi">1</span><span class="p">)):</span>
      <span class="n">m</span> <span class="o">=</span> <span class="n">HomogeneousMeshParameters1D</span><span class="p">(</span><span class="n">cur_min</span><span class="p">,</span> <span class="n">cur_min</span><span class="o">+</span><span class="n">delta</span><span class="p">)</span>
      <span class="n">m</span><span class="o">.</span><span class="n">setSpacingMax</span><span class="p">(</span><span class="n">spacing_max</span><span class="p">)</span>
      <span class="n">m</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;RCD_Z_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
      <span class="n">Z_mesh</span><span class="o">.</span><span class="n">mesh_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>      
      <span class="n">cur_min</span> <span class="o">=</span> <span class="n">cur_min</span> <span class="o">+</span> <span class="n">delta</span>

    <span class="k">return</span><span class="p">(</span><span class="n">Z_mesh</span><span class="p">)</span></div>

<div class="viewcode-block" id="RCD_HexagonalLattice.getUnitCell"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.RCD.RCD_HexagonalLattice.getUnitCell">[docs]</a>  <span class="k">def</span> <span class="nf">getUnitCell</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Get a Distorted object representing the unit cell &#39;&#39;&#39;</span>
    <span class="n">unit_cell</span> <span class="o">=</span> <span class="n">Parallelepiped</span><span class="p">()</span>
    <span class="n">unit_cell</span><span class="o">.</span><span class="n">setDirectionsAndSize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__u1__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__v1__</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">__w1__</span><span class="p">,</span> <span class="p">[</span><span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__u1__</span><span class="p">),</span> <span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__v1__</span><span class="p">),</span> <span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__w1__</span><span class="p">)])</span>
    <span class="n">unit_cell</span><span class="o">.</span><span class="n">setLocation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getLocation</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">unit_cell</span></div>

<div class="viewcode-block" id="RCD_HexagonalLattice.getCubicUnitCell"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.RCD.RCD_HexagonalLattice.getCubicUnitCell">[docs]</a>  <span class="k">def</span> <span class="nf">getCubicUnitCell</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Get a Distorted object representing the cubic unit cell &#39;&#39;&#39;</span>
    <span class="n">unit_cell</span> <span class="o">=</span> <span class="n">Parallelepiped</span><span class="p">()</span>
    <span class="n">u1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.8165</span><span class="p">,</span> <span class="mf">0.57735</span><span class="p">]</span>
    <span class="n">v1</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.70711</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.40825</span><span class="p">,</span> <span class="mf">0.57735</span><span class="p">]</span>
    <span class="n">w1</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.70711</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.40825</span><span class="p">,</span> <span class="mf">0.57735</span><span class="p">]</span>
    <span class="n">unit_cell</span><span class="o">.</span><span class="n">setDirectionsAndSize</span><span class="p">(</span><span class="n">u1</span><span class="p">,</span> <span class="n">v1</span><span class="p">,</span> <span class="n">w1</span><span class="p">,</span> <span class="p">[</span><span class="n">norm</span><span class="p">(</span><span class="n">u1</span><span class="p">),</span> <span class="n">norm</span><span class="p">(</span><span class="n">v1</span><span class="p">),</span> <span class="n">norm</span><span class="p">(</span><span class="n">w1</span><span class="p">)])</span>
    <span class="n">unit_cell</span><span class="o">.</span><span class="n">setLocation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getLocation</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.5</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">getRodLength</span><span class="p">()])</span>
    <span class="k">return</span> <span class="n">unit_cell</span></div>
    
<div class="viewcode-block" id="RCD_HexagonalLattice.getRodLength"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.RCD.RCD_HexagonalLattice.getRodLength">[docs]</a>  <span class="k">def</span> <span class="nf">getRodLength</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">cubic_unit_cell_size</span><span class="p">)</span></div>

<div class="viewcode-block" id="RCD_HexagonalLattice.tetra"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.RCD.RCD_HexagonalLattice.tetra">[docs]</a>  <span class="k">def</span> <span class="nf">tetra</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;tetra&#39;</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Return a list of 4 cylinders aranged as a &quot;tetrahedron&quot;, with one of the cylinders facing downwards.</span>
<span class="sd">    *location* is the position of the point at which all cylinders join.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">geo_list</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_cylinders</span><span class="p">:</span>
      <span class="n">base_cyl</span> <span class="o">=</span> <span class="n">Cylinder</span><span class="p">()</span>
      <span class="n">base_cyl</span><span class="o">.</span><span class="n">setOuterRadius</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outer_radius</span><span class="p">)</span>
      <span class="n">base_cyl</span><span class="o">.</span><span class="n">setRelativeConductivity</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getRelativeConductivity</span><span class="p">())</span>
      <span class="n">base_cyl</span><span class="o">.</span><span class="n">setRelativePermittivity</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getRelativePermittivity</span><span class="p">())</span>

      <span class="n">cyl0</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">base_cyl</span><span class="p">)</span>
      <span class="n">cyl0</span><span class="o">.</span><span class="n">setStartEndPoints</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="n">location</span> <span class="o">+</span> <span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">])</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">cubic_unit_cell_size</span><span class="p">)</span>
      <span class="n">cyl0</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.cyl0&#39;</span><span class="p">)</span>

      <span class="n">cyl1</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">base_cyl</span><span class="p">)</span>
      <span class="n">cyl1</span><span class="o">.</span><span class="n">setStartEndPoints</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="n">location</span> <span class="o">+</span> <span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">12</span><span class="p">])</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">cubic_unit_cell_size</span><span class="p">)</span>
      <span class="n">cyl1</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.cyl1&#39;</span><span class="p">)</span>

      <span class="n">cyl2</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">base_cyl</span><span class="p">)</span>
      <span class="n">cyl2</span><span class="o">.</span><span class="n">setStartEndPoints</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="n">location</span> <span class="o">+</span> <span class="n">array</span><span class="p">([</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">24</span><span class="p">),</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">12</span><span class="p">])</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">cubic_unit_cell_size</span><span class="p">)</span>
      <span class="n">cyl2</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.cyl2&#39;</span><span class="p">)</span>

      <span class="n">cyl3</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">base_cyl</span><span class="p">)</span>
      <span class="n">cyl3</span><span class="o">.</span><span class="n">setStartEndPoints</span><span class="p">(</span><span class="n">location</span><span class="p">,</span> <span class="n">location</span> <span class="o">+</span> <span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">24</span><span class="p">),</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">12</span><span class="p">])</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">cubic_unit_cell_size</span><span class="p">)</span>
      <span class="n">cyl3</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.cyl3&#39;</span><span class="p">)</span>
      
      <span class="n">geo_list</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">cyl0</span><span class="p">,</span> <span class="n">cyl1</span><span class="p">,</span> <span class="n">cyl2</span><span class="p">,</span> <span class="n">cyl3</span><span class="p">])</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_spheres</span><span class="p">:</span>
      <span class="n">base_sphere</span> <span class="o">=</span> <span class="n">Sphere</span><span class="p">()</span>
      <span class="n">base_sphere</span><span class="o">.</span><span class="n">setOuterRadius</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outer_radius</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">relative_sphere_radius</span><span class="p">)</span>
      <span class="n">base_sphere</span><span class="o">.</span><span class="n">setRefractiveIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getRefractiveIndex</span><span class="p">()</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">relative_sphere_index</span><span class="p">)</span>

      <span class="n">sphere0</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">base_sphere</span><span class="p">)</span>
      <span class="n">sphere0</span><span class="o">.</span><span class="n">setLocation</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>
      <span class="n">sphere0</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.sphere0&#39;</span><span class="p">)</span>

      <span class="n">sphere1</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">base_sphere</span><span class="p">)</span>
      <span class="n">sphere1</span><span class="o">.</span><span class="n">setLocation</span><span class="p">(</span><span class="n">location</span> <span class="o">+</span> <span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">12</span><span class="p">])</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">cubic_unit_cell_size</span><span class="p">)</span>
      <span class="n">sphere1</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.sphere1&#39;</span><span class="p">)</span>

      <span class="n">sphere2</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">base_sphere</span><span class="p">)</span>
      <span class="n">sphere2</span><span class="o">.</span><span class="n">setLocation</span><span class="p">(</span><span class="n">location</span> <span class="o">+</span> <span class="n">array</span><span class="p">([</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">24</span><span class="p">),</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">12</span><span class="p">])</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">cubic_unit_cell_size</span><span class="p">)</span>
      <span class="n">sphere2</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.sphere2&#39;</span><span class="p">)</span>

      <span class="n">sphere3</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">base_sphere</span><span class="p">)</span>
      <span class="n">sphere3</span><span class="o">.</span><span class="n">setLocation</span><span class="p">(</span><span class="n">location</span> <span class="o">+</span> <span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">24</span><span class="p">),</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">12</span><span class="p">])</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">cubic_unit_cell_size</span><span class="p">)</span>
      <span class="n">sphere3</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.sphere3&#39;</span><span class="p">)</span>

      <span class="n">geo_list</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">sphere0</span><span class="p">,</span> <span class="n">sphere1</span><span class="p">,</span> <span class="n">sphere2</span><span class="p">,</span> <span class="n">sphere3</span><span class="p">])</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_bottom_sphere</span><span class="p">:</span>
      <span class="n">base_sphere</span> <span class="o">=</span> <span class="n">Sphere</span><span class="p">()</span>
      <span class="n">base_sphere</span><span class="o">.</span><span class="n">setOuterRadius</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outer_radius</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">relative_sphere_radius</span><span class="p">)</span>
      <span class="n">base_sphere</span><span class="o">.</span><span class="n">setRefractiveIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getRefractiveIndex</span><span class="p">()</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">relative_sphere_index</span><span class="p">)</span>

      <span class="n">sphere_bottom</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">base_sphere</span><span class="p">)</span>
      <span class="n">sphere_bottom</span><span class="o">.</span><span class="n">setLocation</span><span class="p">(</span><span class="n">location</span> <span class="o">+</span> <span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">])</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">cubic_unit_cell_size</span><span class="p">)</span>
      <span class="n">sphere_bottom</span><span class="o">.</span><span class="n">setName</span><span class="p">(</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;.sphere_bottom&#39;</span><span class="p">)</span>
      <span class="n">geo_list</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">sphere_bottom</span><span class="p">])</span>
    
    <span class="k">return</span><span class="p">(</span><span class="n">geo_list</span><span class="p">)</span></div>

<div class="viewcode-block" id="RCD_HexagonalLattice.unitCellType1"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.RCD.RCD_HexagonalLattice.unitCellType1">[docs]</a>  <span class="k">def</span> <span class="nf">unitCellType1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    A unit-cell containing 3 &quot;tetrahedrons&quot;.</span>
<span class="sd">    lattice vectors: u1,v1,w1</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">geo_list</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shifted</span><span class="p">:</span>
      <span class="n">offset</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">offset</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="n">unit_cell_location</span> <span class="o">=</span> <span class="n">offset</span> <span class="o">+</span> <span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">__u1__</span> <span class="o">+</span> <span class="n">j</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">__v1__</span> <span class="o">+</span> <span class="n">k</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">__w1__</span>
    
    <span class="n">geo_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tetra</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span> <span class="o">+</span> <span class="p">(</span><span class="n">unit_cell_location</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">__offset1__</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">__R0__</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">cubic_unit_cell_size</span><span class="p">,</span> <span class="s1">&#39;cell.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">.R0&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span>
    <span class="n">geo_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tetra</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span> <span class="o">+</span> <span class="p">(</span><span class="n">unit_cell_location</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">__offset1__</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">__G0__</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">cubic_unit_cell_size</span><span class="p">,</span> <span class="s1">&#39;cell.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">.G0&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span>
    <span class="n">geo_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tetra</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span> <span class="o">+</span> <span class="p">(</span><span class="n">unit_cell_location</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">__offset1__</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">__B0__</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">cubic_unit_cell_size</span><span class="p">,</span> <span class="s1">&#39;cell.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">.B0&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span>

    <span class="k">return</span><span class="p">(</span><span class="n">geo_list</span><span class="p">)</span></div>
  
<div class="viewcode-block" id="RCD_HexagonalLattice.unitCellType2"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.RCD.RCD_HexagonalLattice.unitCellType2">[docs]</a>  <span class="k">def</span> <span class="nf">unitCellType2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    A unit-cell containing 6 &quot;tetrahedrons&quot;.</span>
<span class="sd">    lattice vectors: u2,v2,w2</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">geo_list</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shifted</span><span class="p">:</span>
      <span class="n">offset</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">offset</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="n">unit_cell_location</span> <span class="o">=</span> <span class="n">offset</span> <span class="o">+</span> <span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">__u2__</span> <span class="o">+</span> <span class="n">j</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">__v2__</span> <span class="o">+</span> <span class="n">k</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">__w2__</span>
    
    <span class="n">geo_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tetra</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span> <span class="o">+</span> <span class="p">(</span><span class="n">unit_cell_location</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">__offset2__</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">__R1__</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">cubic_unit_cell_size</span><span class="p">,</span> <span class="s1">&#39;cell.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">.R1&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span>
    <span class="n">geo_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tetra</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span> <span class="o">+</span> <span class="p">(</span><span class="n">unit_cell_location</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">__offset2__</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">__G1__</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">cubic_unit_cell_size</span><span class="p">,</span> <span class="s1">&#39;cell.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">.G1&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span>
    <span class="n">geo_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tetra</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span> <span class="o">+</span> <span class="p">(</span><span class="n">unit_cell_location</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">__offset2__</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">__B1__</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">cubic_unit_cell_size</span><span class="p">,</span> <span class="s1">&#39;cell.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">.B1&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span>

    <span class="n">geo_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tetra</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span> <span class="o">+</span> <span class="p">(</span><span class="n">unit_cell_location</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">__offset2__</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">__R2__</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">cubic_unit_cell_size</span><span class="p">,</span> <span class="s1">&#39;cell.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">.R2&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span>
    <span class="n">geo_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tetra</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span> <span class="o">+</span> <span class="p">(</span><span class="n">unit_cell_location</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">__offset2__</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">__G2__</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">cubic_unit_cell_size</span><span class="p">,</span> <span class="s1">&#39;cell.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">.G2&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span>
    <span class="n">geo_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tetra</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span> <span class="o">+</span> <span class="p">(</span><span class="n">unit_cell_location</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">__offset2__</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">__B2__</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">cubic_unit_cell_size</span><span class="p">,</span> <span class="s1">&#39;cell.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">.B2&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span>

    <span class="k">return</span><span class="p">(</span><span class="n">geo_list</span><span class="p">)</span></div>
  
<div class="viewcode-block" id="RCD_HexagonalLattice.createGeoList"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.RCD.RCD_HexagonalLattice.createGeoList">[docs]</a>  <span class="k">def</span> <span class="nf">createGeoList</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_cell_index_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">createRectangularArray</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">geo_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_cell_index_list</span><span class="p">:</span>
      <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">unit_cell_type</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geo_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unitCellType1</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">geo_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unitCellType2</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span>        
    <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geo_list</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="RCD_HexagonalLattice.createRectangularArray"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.RCD.RCD_HexagonalLattice.createRectangularArray">[docs]</a>  <span class="k">def</span> <span class="nf">createRectangularArray</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Nx</span><span class="p">,</span> <span class="n">Ny</span><span class="p">,</span> <span class="n">Nz</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">unit_cell_index_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nx</span><span class="p">):</span>
      <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Ny</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nz</span><span class="p">):</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">unit_cell_index_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span>
    <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unit_cell_index_list</span><span class="p">)</span></div>

<div class="viewcode-block" id="RCD_HexagonalLattice.createRectangularArraySymmetrical"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.RCD.RCD_HexagonalLattice.createRectangularArraySymmetrical">[docs]</a>  <span class="k">def</span> <span class="nf">createRectangularArraySymmetrical</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Nx</span><span class="p">,</span> <span class="n">Ny</span><span class="p">,</span> <span class="n">Nz</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">unit_cell_index_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="n">Nx</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">Nx</span><span class="p">):</span>
      <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="n">Ny</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">Ny</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="n">Nz</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">Nz</span><span class="p">):</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">unit_cell_index_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span>
    <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unit_cell_index_list</span><span class="p">)</span></div>

<div class="viewcode-block" id="RCD_HexagonalLattice.fillBox"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.RCD.RCD_HexagonalLattice.fillBox">[docs]</a>  <span class="k">def</span> <span class="nf">fillBox</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
    <span class="n">location</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>
    <span class="n">size</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
    <span class="n">e1</span><span class="p">,</span> <span class="n">e2</span><span class="p">,</span> <span class="n">e3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLatticeVectors</span><span class="p">()</span>
    <span class="n">sx</span> <span class="o">=</span> <span class="n">e1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">sy</span> <span class="o">=</span> <span class="n">e2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">sz</span> <span class="o">=</span> <span class="n">e3</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">L</span> <span class="o">=</span> <span class="n">location</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">size</span>
    <span class="n">U</span> <span class="o">=</span> <span class="n">location</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">size</span>
    
    <span class="n">i_min</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">sx</span><span class="p">))</span>
    <span class="n">i_max</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">U</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">sx</span><span class="p">))</span>
    
    <span class="n">j_min</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">sy</span><span class="p">))</span>
    <span class="n">j_max</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">U</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">sy</span><span class="p">))</span>
    
    <span class="n">k_min</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">L</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">sz</span><span class="p">))</span>
    <span class="n">k_max</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">U</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="n">sz</span><span class="p">))</span>

    <span class="c1"># print(&#39;i: [{}, {}]&#39;.format(i_min, i_max))</span>
    <span class="c1"># print(&#39;j: [{}, {}]&#39;.format(j_min, j_max))</span>
    <span class="c1"># print(&#39;k: [{}, {}]&#39;.format(k_min, k_max))</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">unit_cell_index_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i_min</span><span class="p">,</span> <span class="n">i_max</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
      <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j_min</span><span class="p">,</span> <span class="n">j_max</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k_min</span><span class="p">,</span> <span class="n">k_max</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
          <span class="bp">self</span><span class="o">.</span><span class="n">unit_cell_index_list</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">))</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">createGeoList</span><span class="p">()</span>

    <span class="n">box</span> <span class="o">=</span> <span class="n">Block</span><span class="p">()</span>
    <span class="n">box</span><span class="o">.</span><span class="n">setLocation</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>
    <span class="n">box</span><span class="o">.</span><span class="n">setSize</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>

    <span class="c1"># the pythonic way to do things:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">geo_list</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="k">lambda</span> <span class="n">cyl</span><span class="p">:</span> <span class="n">cyl</span><span class="o">.</span><span class="n">AABB_intersects</span><span class="p">(</span><span class="n">box</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">geo_list</span><span class="p">)</span>
    
    <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unit_cell_index_list</span><span class="p">)</span></div>
  
<div class="viewcode-block" id="RCD_HexagonalLattice.write_entry"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.RCD.RCD_HexagonalLattice.write_entry">[docs]</a>  <span class="k">def</span> <span class="nf">write_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">FILE</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getGeoList</span><span class="p">():</span>
      <span class="n">obj</span><span class="o">.</span><span class="n">write_entry</span><span class="p">(</span><span class="n">FILE</span><span class="p">)</span></div>
      
<div class="viewcode-block" id="RCD_HexagonalLattice.getIndexOf"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.RCD.RCD_HexagonalLattice.getIndexOf">[docs]</a>  <span class="k">def</span> <span class="nf">getIndexOf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">tetra_location</span><span class="p">,</span> <span class="n">tetra_cylinder</span><span class="p">):</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">getGeoList</span><span class="p">()]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;cell.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">.cyl</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">tetra_location</span><span class="p">,</span> <span class="n">tetra_cylinder</span><span class="p">))</span>
    <span class="k">return</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span></div>

<div class="viewcode-block" id="RCD_HexagonalLattice.clearGeoList"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.RCD.RCD_HexagonalLattice.clearGeoList">[docs]</a>  <span class="k">def</span> <span class="nf">clearGeoList</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1"># TODO: Check if we need to do a proper clear, i.e. delete all elements (might be problem if it&#39;s a copy, due to breaking original)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">geo_list</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">return</span></div>

<div class="viewcode-block" id="RCD_HexagonalLattice.getGeoList"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.RCD.RCD_HexagonalLattice.getGeoList">[docs]</a>  <span class="k">def</span> <span class="nf">getGeoList</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">geo_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">createGeoList</span><span class="p">()</span>
    <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">geo_list</span><span class="p">)</span></div>

<div class="viewcode-block" id="RCD_HexagonalLattice.getMeshObject"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.RCD.RCD_HexagonalLattice.getMeshObject">[docs]</a>  <span class="k">def</span> <span class="nf">getMeshObject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Nx</span><span class="p">,</span> <span class="n">Ny</span><span class="p">,</span> <span class="n">Nz</span><span class="p">):</span>
    <span class="c1"># quick and dirty meshing...</span>
    <span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">,</span><span class="n">w</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLatticeVectors</span><span class="p">()</span>
    
    <span class="n">RCD_size_x</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">Nx</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">norm</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
    <span class="n">RCD_size_y</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">Ny</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="mi">2</span><span class="o">/</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
    <span class="n">RCD_size_z</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">Nz</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">norm</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>

    <span class="n">RCD_min_x</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">Nx</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">norm</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
    <span class="n">RCD_min_y</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">Ny</span><span class="o">-</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
    <span class="n">RCD_min_z</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="n">Nz</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">norm</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">__offset2__</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">cubic_unit_cell_size</span>

    <span class="n">RCD_delta_x</span> <span class="o">=</span> <span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">Nx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="n">norm</span><span class="p">(</span><span class="n">u</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">RCD_delta_y</span> <span class="o">=</span> <span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="n">Ny</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">6</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="n">norm</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">/</span><span class="mi">6</span><span class="p">]</span>
    <span class="n">RCD_delta_z</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">Nz</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">3</span><span class="o">*</span><span class="p">[</span><span class="n">norm</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">/</span><span class="mi">8</span><span class="p">,</span> <span class="n">norm</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">/</span><span class="mi">8</span><span class="p">,</span> <span class="n">norm</span><span class="p">(</span><span class="n">w</span><span class="p">)</span><span class="o">/</span><span class="mi">12</span><span class="p">]</span>

    <span class="n">RCD_mesh</span> <span class="o">=</span> <span class="n">MeshObject</span><span class="p">()</span>
    <span class="n">RCD_mesh</span><span class="o">.</span><span class="n">setXmeshDelta</span><span class="p">(</span><span class="n">RCD_delta_x</span><span class="p">)</span>
    <span class="n">RCD_mesh</span><span class="o">.</span><span class="n">setYmeshDelta</span><span class="p">(</span><span class="n">RCD_delta_y</span><span class="p">)</span>
    <span class="n">RCD_mesh</span><span class="o">.</span><span class="n">setZmeshDelta</span><span class="p">(</span><span class="n">RCD_delta_z</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">RCD_mesh</span><span class="p">)</span></div>
  
<div class="viewcode-block" id="RCD_HexagonalLattice.createBlenderObject"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.RCD.RCD_HexagonalLattice.createBlenderObject">[docs]</a>  <span class="k">def</span> <span class="nf">createBlenderObject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">blender_operator</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
    <span class="c1"># Creates a unit-cell of the crystal in blender and returns the created object</span>
    
    <span class="c1"># import necessary packages</span>
    <span class="kn">import</span> <span class="nn">bpy</span>
    <span class="kn">import</span> <span class="nn">numpy</span>
    
    <span class="kn">from</span> <span class="nn">blender_scripts.modules.GeometryObjects</span> <span class="k">import</span> <span class="n">add_cylinder</span><span class="p">,</span> <span class="n">add_tetra</span><span class="p">,</span> <span class="n">add_block</span>
    <span class="kn">from</span> <span class="nn">blender_scripts.modules.blender_utilities</span> <span class="k">import</span> <span class="n">selectObjects</span><span class="p">,</span> <span class="n">joinObjects</span>
    
    <span class="c1"># get cursor location for placement</span>
    <span class="n">cursor_location3</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bpy</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">cursor_location</span><span class="p">)</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">setLocation</span><span class="p">(</span><span class="n">cursor_location3</span><span class="p">)</span>
    
    <span class="n">geo_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getGeoList</span><span class="p">()</span>
    
    <span class="n">cyl_blender_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">cyl_BFDTD</span> <span class="ow">in</span> <span class="n">geo_list</span><span class="p">:</span>
      <span class="n">cyl_blender</span> <span class="o">=</span> <span class="n">cyl_BFDTD</span><span class="o">.</span><span class="n">createBlenderObject</span><span class="p">(</span><span class="n">blender_operator</span><span class="p">,</span> <span class="n">context</span><span class="p">)</span>
      <span class="n">cyl_blender_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cyl_blender</span><span class="p">)</span>
    
    <span class="c1">#obj = add_cylinder(self, [0,0,0], [1,1,1], name=&#39;Cylinder&#39;, cylinder_radius=0.1)</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="n">joinObjects</span><span class="p">(</span><span class="n">cyl_blender_list</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="n">cursor_location3</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;RCD111&#39;</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">context</span><span class="p">)</span>
    <span class="n">bpy</span><span class="o">.</span><span class="n">ops</span><span class="o">.</span><span class="n">object</span><span class="o">.</span><span class="n">transform_apply</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="k">return</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="FRD_HexagonalLattice"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.RCD.FRD_HexagonalLattice">[docs]</a><span class="k">class</span> <span class="nc">FRD_HexagonalLattice</span><span class="p">(</span><span class="n">RCD_HexagonalLattice</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">RCD_on</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">refractive_index_RCD</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">FRD_on</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">refractive_index_FRD</span> <span class="o">=</span> <span class="mi">1</span>
  
<div class="viewcode-block" id="FRD_HexagonalLattice.unitCellType1"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.RCD.FRD_HexagonalLattice.unitCellType1">[docs]</a>  <span class="k">def</span> <span class="nf">unitCellType1</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    A unit-cell containing 3 &quot;tetrahedrons&quot;.</span>
<span class="sd">    lattice vectors: u1,v1,w1</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">raise</span><span class="p">()</span>

    <span class="n">geo_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">unit_cell_location</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">__u1__</span> <span class="o">+</span> <span class="n">j</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">__v1__</span> <span class="o">+</span> <span class="n">k</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">__w1__</span>
    
    <span class="n">geo_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tetra</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span> <span class="o">+</span> <span class="p">(</span><span class="n">unit_cell_location</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">__offset1__</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">__R0__</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">cubic_unit_cell_size</span><span class="p">,</span> <span class="s1">&#39;cell.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">.R0&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span>
    <span class="n">geo_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tetra</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span> <span class="o">+</span> <span class="p">(</span><span class="n">unit_cell_location</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">__offset1__</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">__G0__</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">cubic_unit_cell_size</span><span class="p">,</span> <span class="s1">&#39;cell.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">.G0&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span>
    <span class="n">geo_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tetra</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span> <span class="o">+</span> <span class="p">(</span><span class="n">unit_cell_location</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">__offset1__</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">__B0__</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">cubic_unit_cell_size</span><span class="p">,</span> <span class="s1">&#39;cell.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">.B0&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span>

    <span class="k">return</span><span class="p">(</span><span class="n">geo_list</span><span class="p">)</span></div>
  
<div class="viewcode-block" id="FRD_HexagonalLattice.unitCellType2"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.RCD.FRD_HexagonalLattice.unitCellType2">[docs]</a>  <span class="k">def</span> <span class="nf">unitCellType2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    A unit-cell containing 6 &quot;tetrahedrons&quot;.</span>
<span class="sd">    lattice vectors: u2,v2,w2</span>
<span class="sd">    &#39;&#39;&#39;</span>

    
    <span class="c1">#self.setRefractiveIndex(self.refractive_index_RCD)</span>
    
    <span class="n">geo_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">unit_cell_location</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">__u2__</span> <span class="o">+</span> <span class="n">j</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">__v2__</span> <span class="o">+</span> <span class="n">k</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">__w2__</span>

    <span class="c1"># TODO: Check why +sqrt(3)/4 and not -sqrt(3)/4 (Actually works with both. cf FRD symmetries.)</span>
    <span class="n">FRD_offset</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">])</span>

    <span class="c1"># RCD part</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">RCD_on</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">setRefractiveIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">refractive_index_RCD</span><span class="p">)</span>
      <span class="n">geo_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tetra</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span> <span class="o">+</span> <span class="p">(</span><span class="n">unit_cell_location</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">__offset2__</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">__R1__</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">cubic_unit_cell_size</span><span class="p">,</span> <span class="s1">&#39;cell.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">.R1&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span>
      <span class="n">geo_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tetra</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span> <span class="o">+</span> <span class="p">(</span><span class="n">unit_cell_location</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">__offset2__</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">__G1__</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">cubic_unit_cell_size</span><span class="p">,</span> <span class="s1">&#39;cell.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">.G1&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span>
      <span class="n">geo_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tetra</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span> <span class="o">+</span> <span class="p">(</span><span class="n">unit_cell_location</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">__offset2__</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">__B1__</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">cubic_unit_cell_size</span><span class="p">,</span> <span class="s1">&#39;cell.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">.B1&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span>

      <span class="n">geo_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tetra</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span> <span class="o">+</span> <span class="p">(</span><span class="n">unit_cell_location</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">__offset2__</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">__R2__</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">cubic_unit_cell_size</span><span class="p">,</span> <span class="s1">&#39;cell.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">.R2&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span>
      <span class="n">geo_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tetra</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span> <span class="o">+</span> <span class="p">(</span><span class="n">unit_cell_location</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">__offset2__</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">__G2__</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">cubic_unit_cell_size</span><span class="p">,</span> <span class="s1">&#39;cell.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">.G2&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span>
      <span class="n">geo_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tetra</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span> <span class="o">+</span> <span class="p">(</span><span class="n">unit_cell_location</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">__offset2__</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">__B2__</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">cubic_unit_cell_size</span><span class="p">,</span> <span class="s1">&#39;cell.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">.B2&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span>

    <span class="c1"># FRD part</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">FRD_on</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">setRefractiveIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">refractive_index_FRD</span><span class="p">)</span>
      <span class="n">geo_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tetra</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span> <span class="o">+</span> <span class="p">(</span><span class="n">FRD_offset</span> <span class="o">+</span> <span class="n">unit_cell_location</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">__offset2__</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">__R1__</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">cubic_unit_cell_size</span><span class="p">,</span> <span class="s1">&#39;cell.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">.R1.FRD&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span>
      <span class="n">geo_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tetra</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span> <span class="o">+</span> <span class="p">(</span><span class="n">FRD_offset</span> <span class="o">+</span> <span class="n">unit_cell_location</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">__offset2__</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">__G1__</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">cubic_unit_cell_size</span><span class="p">,</span> <span class="s1">&#39;cell.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">.G1.FRD&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span>
      <span class="n">geo_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tetra</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span> <span class="o">+</span> <span class="p">(</span><span class="n">FRD_offset</span> <span class="o">+</span> <span class="n">unit_cell_location</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">__offset2__</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">__B1__</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">cubic_unit_cell_size</span><span class="p">,</span> <span class="s1">&#39;cell.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">.B1.FRD&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span>

      <span class="n">geo_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tetra</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span> <span class="o">+</span> <span class="p">(</span><span class="n">FRD_offset</span> <span class="o">+</span> <span class="n">unit_cell_location</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">__offset2__</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">__R2__</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">cubic_unit_cell_size</span><span class="p">,</span> <span class="s1">&#39;cell.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">.R2.FRD&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span>
      <span class="n">geo_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tetra</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span> <span class="o">+</span> <span class="p">(</span><span class="n">FRD_offset</span> <span class="o">+</span> <span class="n">unit_cell_location</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">__offset2__</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">__G2__</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">cubic_unit_cell_size</span><span class="p">,</span> <span class="s1">&#39;cell.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">.G2.FRD&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span>
      <span class="n">geo_list</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tetra</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span> <span class="o">+</span> <span class="p">(</span><span class="n">FRD_offset</span> <span class="o">+</span> <span class="n">unit_cell_location</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">__offset2__</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">__B2__</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">cubic_unit_cell_size</span><span class="p">,</span> <span class="s1">&#39;cell.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">.</span><span class="si">{}</span><span class="s1">.B2.FRD&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)))</span>

    <span class="k">return</span><span class="p">(</span><span class="n">geo_list</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="RCD_vector_dictionary"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.RCD.RCD_vector_dictionary">[docs]</a><span class="k">def</span> <span class="nf">RCD_vector_dictionary</span><span class="p">():</span>
  <span class="n">V</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
  <span class="n">V_groups</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
  
  <span class="c1"># conventional basis</span>
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
  <span class="n">V_groups</span><span class="p">[</span><span class="s1">&#39;Conventional basis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">)</span>
  <span class="c1"># RCD111 basis</span>
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;x-RCD111&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;y-RCD111&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;z-RCD111&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
  <span class="n">V_groups</span><span class="p">[</span><span class="s1">&#39;RCD111 basis&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;x-RCD111&#39;</span><span class="p">,</span> <span class="s1">&#39;y-RCD111&#39;</span><span class="p">,</span> <span class="s1">&#39;z-RCD111&#39;</span><span class="p">)</span>
  
  <span class="c1"># RCD111 vectors</span>
  <span class="n">RCD111</span> <span class="o">=</span> <span class="n">RCD_HexagonalLattice</span><span class="p">()</span>
  
  <span class="c1"># The tetrahedron centres</span>
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;R0&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">RCD111</span><span class="o">.</span><span class="n">__R0__</span>
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;R1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">RCD111</span><span class="o">.</span><span class="n">__R1__</span>
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;R2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">RCD111</span><span class="o">.</span><span class="n">__R2__</span>
  
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;G0&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">RCD111</span><span class="o">.</span><span class="n">__G0__</span>
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;G1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">RCD111</span><span class="o">.</span><span class="n">__G1__</span>
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;G2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">RCD111</span><span class="o">.</span><span class="n">__G2__</span>
  
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;B0&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">RCD111</span><span class="o">.</span><span class="n">__B0__</span>
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;B1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">RCD111</span><span class="o">.</span><span class="n">__B1__</span>
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;B2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">RCD111</span><span class="o">.</span><span class="n">__B2__</span>
  <span class="n">V_groups</span><span class="p">[</span><span class="s1">&#39;RCD111-tetrahedron-centres&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;R0&#39;</span><span class="p">,</span><span class="s1">&#39;R1&#39;</span><span class="p">,</span><span class="s1">&#39;R2&#39;</span><span class="p">,</span> <span class="s1">&#39;G0&#39;</span><span class="p">,</span><span class="s1">&#39;G1&#39;</span><span class="p">,</span><span class="s1">&#39;G2&#39;</span><span class="p">,</span> <span class="s1">&#39;B0&#39;</span><span class="p">,</span> <span class="s1">&#39;B1&#39;</span><span class="p">,</span> <span class="s1">&#39;B2&#39;</span><span class="p">)</span>
  
  <span class="c1"># cell type 1 parameters</span>
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;offset1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">RCD111</span><span class="o">.</span><span class="n">__offset1__</span>
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;u1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">RCD111</span><span class="o">.</span><span class="n">__u1__</span>
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;v1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">RCD111</span><span class="o">.</span><span class="n">__v1__</span>
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;w1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">RCD111</span><span class="o">.</span><span class="n">__w1__</span>
  <span class="n">V_groups</span><span class="p">[</span><span class="s1">&#39;RCD111-type1-parameters&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;offset1&#39;</span><span class="p">,</span> <span class="s1">&#39;u1&#39;</span><span class="p">,</span> <span class="s1">&#39;v1&#39;</span><span class="p">,</span> <span class="s1">&#39;w1&#39;</span><span class="p">)</span>
  
  <span class="c1"># cell type 2 parameters</span>
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;offset2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">RCD111</span><span class="o">.</span><span class="n">__offset2__</span>
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;u2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">RCD111</span><span class="o">.</span><span class="n">__u2__</span>
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;v2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">RCD111</span><span class="o">.</span><span class="n">__v2__</span>
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;w2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">RCD111</span><span class="o">.</span><span class="n">__w2__</span>
  <span class="n">V_groups</span><span class="p">[</span><span class="s1">&#39;RCD111-type2-parameters&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;offset2&#39;</span><span class="p">,</span> <span class="s1">&#39;u2&#39;</span><span class="p">,</span> <span class="s1">&#39;v2&#39;</span><span class="p">,</span> <span class="s1">&#39;w2&#39;</span><span class="p">)</span>
  
  <span class="c1">#V[&#39;Conventional basis&#39;] = (&#39;x&#39;, &#39;y&#39;, &#39;z&#39;)</span>
  <span class="c1">#V[&#39;RCD111 basis&#39;] = (&#39;x-RCD111&#39;, &#39;y-RCD111&#39;, &#39;z-RCD111&#39;)</span>
  
  <span class="c1"># transformation matrices</span>
  <span class="n">M_RCD111_to_conventional</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">V</span><span class="p">[</span><span class="s1">&#39;x-RCD111&#39;</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="s1">&#39;y-RCD111&#39;</span><span class="p">],</span> <span class="n">V</span><span class="p">[</span><span class="s1">&#39;z-RCD111&#39;</span><span class="p">]])</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
  <span class="n">M_conventional_to_RCD111</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">M_RCD111_to_conventional</span><span class="p">)</span>
  
  <span class="p">(</span><span class="n">FCC_BZ_V</span><span class="p">,</span> <span class="n">FCC_BZ_V_groups</span><span class="p">)</span> <span class="o">=</span> <span class="n">FCC_BZ_dictionary</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
  <span class="c1">#V = {**V, **FCC_BZ_V}</span>
  <span class="c1">#V_groups = {**V_groups, **FCC_BZ_V_groups}</span>
  
  <span class="p">(</span><span class="n">output_V</span><span class="p">,</span> <span class="n">output_V_groups</span><span class="p">)</span> <span class="o">=</span> <span class="n">apply_transform</span><span class="p">(</span><span class="n">FCC_BZ_V</span><span class="p">,</span> <span class="n">FCC_BZ_V_groups</span><span class="p">,</span> <span class="n">M_conventional_to_RCD111</span><span class="p">,</span> <span class="mf">0.5</span><span class="o">*</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;-RCD111-1&#39;</span><span class="p">)</span>
  <span class="n">V</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="n">V</span><span class="p">,</span> <span class="o">**</span><span class="n">output_V</span><span class="p">}</span>
  <span class="n">V_groups</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="n">V_groups</span><span class="p">,</span> <span class="o">**</span><span class="n">output_V_groups</span><span class="p">}</span>
  
  <span class="p">(</span><span class="n">output_V</span><span class="p">,</span> <span class="n">output_V_groups</span><span class="p">)</span> <span class="o">=</span> <span class="n">apply_transform</span><span class="p">(</span><span class="n">FCC_BZ_V</span><span class="p">,</span> <span class="n">FCC_BZ_V_groups</span><span class="p">,</span> <span class="n">M_conventional_to_RCD111</span><span class="p">,</span> <span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;-RCD111-2&#39;</span><span class="p">)</span>
  <span class="n">V</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="n">V</span><span class="p">,</span> <span class="o">**</span><span class="n">output_V</span><span class="p">}</span>
  <span class="n">V_groups</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="n">V_groups</span><span class="p">,</span> <span class="o">**</span><span class="n">output_V_groups</span><span class="p">}</span>
  
  <span class="c1">#print(&#39;-----------&#39;)</span>
  <span class="c1">#print(M_RCD111_to_conventional.dot(numpy.array([1,0,0])))</span>
  <span class="c1">#print(V[&#39;x-RCD111&#39;])</span>
  <span class="c1">#print(&#39;-----------&#39;)</span>
  <span class="c1">#print(M_RCD111_to_conventional.dot(numpy.array([0,1,0])))</span>
  <span class="c1">#print(V[&#39;y-RCD111&#39;])</span>
  <span class="c1">#print(&#39;-----------&#39;)</span>
  <span class="c1">#print(M_RCD111_to_conventional.dot(numpy.array([0,0,1])))</span>
  <span class="c1">#print(V[&#39;z-RCD111&#39;])</span>
  <span class="c1">#print(&#39;-----------&#39;)</span>
  <span class="c1">#print(M_conventional_to_RCD111.dot(V[&#39;x-RCD111&#39;]))</span>
  <span class="c1">#print(M_conventional_to_RCD111.dot(V[&#39;y-RCD111&#39;]))</span>
  <span class="c1">#print(M_conventional_to_RCD111.dot(V[&#39;z-RCD111&#39;]))</span>
  <span class="c1">#print(&#39;-----------&#39;)</span>
  
  <span class="c1">## add suffix, rotate and scale</span>
  <span class="c1">#suffix = &#39;-RCD111&#39;</span>
  <span class="c1">#for idx, key in enumerate(FCC_BZ_V):</span>
    <span class="c1">#new_key = key + suffix</span>
    <span class="c1">#new_vector = M_conventional_to_RCD111.dot(FCC_BZ_V[key])</span>
    <span class="c1">#V[new_key] = new_vector</span>
  
  <span class="c1">#for idx, key in enumerate(FCC_BZ_V_groups):</span>
    <span class="c1">#old_list = FCC_BZ_V_groups[key]</span>
    <span class="c1">#new_list = []</span>
    <span class="c1">#for i in old_list:</span>
      <span class="c1">#new_list.append(i + suffix)</span>
    <span class="c1">#V_groups[key+suffix] = new_list</span>
    
  <span class="k">return</span> <span class="p">(</span><span class="n">V</span> <span class="p">,</span> <span class="n">V_groups</span><span class="p">)</span></div>

<div class="viewcode-block" id="FCC_BZ_dictionary"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.RCD.FCC_BZ_dictionary">[docs]</a><span class="k">def</span> <span class="nf">FCC_BZ_dictionary</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
  <span class="c1"># .. todo:: Use BrillouinZoneFCT() from BZ addon (or otherwise reduce code duplication)</span>
  <span class="n">V</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
  <span class="n">V_groups</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
  
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;a1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;a2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;a3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
  <span class="n">V_groups</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;a1&#39;</span><span class="p">,</span> <span class="s1">&#39;a2&#39;</span><span class="p">,</span> <span class="s1">&#39;a3&#39;</span><span class="p">)</span>
  
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;b1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;b2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;b3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
  <span class="n">V_groups</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;b1&#39;</span><span class="p">,</span> <span class="s1">&#39;b2&#39;</span><span class="p">,</span> <span class="s1">&#39;b3&#39;</span><span class="p">)</span>
  
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;Gamma&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
  
  <span class="n">V_groups</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">k</span> <span class="o">=</span> <span class="s1">&#39;X&#39;</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;-x&#39;</span><span class="p">,</span><span class="s1">&#39;+x&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">];</span> <span class="n">V</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]);</span> <span class="n">V_groups</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
    <span class="n">k</span> <span class="o">=</span> <span class="s1">&#39;X&#39;</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;-y&#39;</span><span class="p">,</span><span class="s1">&#39;+y&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">];</span> <span class="n">V</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">]);</span> <span class="n">V_groups</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
    <span class="n">k</span> <span class="o">=</span> <span class="s1">&#39;X&#39;</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;-z&#39;</span><span class="p">,</span><span class="s1">&#39;+z&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">];</span> <span class="n">V</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]]);</span> <span class="n">V_groups</span><span class="p">[</span><span class="s1">&#39;X&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
    
  <span class="n">V_groups</span><span class="p">[</span><span class="s1">&#39;K&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
      <span class="n">k</span> <span class="o">=</span> <span class="s1">&#39;K&#39;</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;-x&#39;</span><span class="p">,</span><span class="s1">&#39;+x&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;-y&#39;</span><span class="p">,</span><span class="s1">&#39;+y&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
      <span class="n">V</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">],</span> <span class="mi">0</span><span class="p">])</span>
      <span class="n">V_groups</span><span class="p">[</span><span class="s1">&#39;K&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
      
      <span class="n">k</span> <span class="o">=</span> <span class="s1">&#39;K&#39;</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;-y&#39;</span><span class="p">,</span><span class="s1">&#39;+y&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;-z&#39;</span><span class="p">,</span><span class="s1">&#39;+z&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
      <span class="n">V</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]])</span>
      <span class="n">V_groups</span><span class="p">[</span><span class="s1">&#39;K&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
      
      <span class="n">k</span> <span class="o">=</span> <span class="s1">&#39;K&#39;</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;-x&#39;</span><span class="p">,</span><span class="s1">&#39;+x&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;-z&#39;</span><span class="p">,</span><span class="s1">&#39;+z&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
      <span class="n">V</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]])</span>
      <span class="n">V_groups</span><span class="p">[</span><span class="s1">&#39;K&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
  
  <span class="n">V_groups</span><span class="p">[</span><span class="s1">&#39;L&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
      <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
        <span class="n">key</span> <span class="o">=</span> <span class="s1">&#39;L&#39;</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;-x&#39;</span><span class="p">,</span><span class="s1">&#39;+x&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;-y&#39;</span><span class="p">,</span><span class="s1">&#39;+y&#39;</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;-z&#39;</span><span class="p">,</span><span class="s1">&#39;+z&#39;</span><span class="p">][</span><span class="n">k</span><span class="p">]</span>
        <span class="n">V</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">][</span><span class="n">k</span><span class="p">]])</span>
        <span class="n">V_groups</span><span class="p">[</span><span class="s1">&#39;L&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
  
  <span class="c1"># add prefix and scale</span>
  <span class="n">prefix</span> <span class="o">=</span> <span class="s1">&#39;FCC-BZ-&#39;</span>
  <span class="n">key_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">V</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
  <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">key_list</span><span class="p">:</span>
    <span class="n">V</span><span class="p">[</span><span class="n">prefix</span><span class="o">+</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">scale</span><span class="o">*</span><span class="n">V</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
  <span class="n">key_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">V_groups</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
  <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">key_list</span><span class="p">:</span>
    <span class="n">group_old</span> <span class="o">=</span> <span class="n">V_groups</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
    <span class="n">group_new</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">group_old</span><span class="p">):</span>
      <span class="n">group_new</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prefix</span> <span class="o">+</span> <span class="n">val</span><span class="p">)</span>
    <span class="n">V_groups</span><span class="p">[</span><span class="n">prefix</span><span class="o">+</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">group_new</span>
    
    <span class="c1">#V_groups[prefix+k] = V_groups.pop(k)</span>
    <span class="c1">#for idx, val in enumerate(V_groups[prefix+k]):</span>
      <span class="c1">#V_groups[prefix+k][idx] = prefix + V_groups[prefix+k][idx]</span>
  
  <span class="k">return</span> <span class="p">(</span><span class="n">V</span> <span class="p">,</span> <span class="n">V_groups</span><span class="p">)</span></div>

<div class="viewcode-block" id="apply_transform"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.RCD.apply_transform">[docs]</a><span class="k">def</span> <span class="nf">apply_transform</span><span class="p">(</span><span class="n">input_V</span><span class="p">,</span> <span class="n">input_V_groups</span><span class="p">,</span> <span class="n">mat3</span><span class="p">,</span> <span class="n">scale</span><span class="p">,</span> <span class="n">suffix</span><span class="p">):</span>
  <span class="c1"># add suffix, rotate and scale</span>
  <span class="c1"># .. todo:: V, V_groups could become a new class/object?</span>
  <span class="c1"># .. todo:: add_suffix/add_prefix functions?</span>
  <span class="c1"># .. todo:: have rotation/scaling as option in the add_arrow addon? use blender&#39;s add object helper&#39;s feature to align with axis?</span>
  <span class="n">output_V</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
  <span class="n">output_V_groups</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
  <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">input_V</span><span class="p">):</span>
    <span class="n">new_key</span> <span class="o">=</span> <span class="n">key</span> <span class="o">+</span> <span class="n">suffix</span>
    <span class="n">new_vector</span> <span class="o">=</span> <span class="n">scale</span><span class="o">*</span><span class="n">mat3</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">input_V</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
    <span class="n">output_V</span><span class="p">[</span><span class="n">new_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_vector</span>
  
  <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">input_V_groups</span><span class="p">):</span>
    <span class="n">old_list</span> <span class="o">=</span> <span class="n">input_V_groups</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
    <span class="n">new_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">old_list</span><span class="p">:</span>
      <span class="n">new_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">suffix</span><span class="p">)</span>
    <span class="n">output_V_groups</span><span class="p">[</span><span class="n">key</span><span class="o">+</span><span class="n">suffix</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_list</span>
  <span class="k">return</span> <span class="p">(</span><span class="n">output_V</span><span class="p">,</span> <span class="n">output_V_groups</span><span class="p">)</span></div>

<div class="viewcode-block" id="RCD111_waveguide_vector_dictionary"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.RCD.RCD111_waveguide_vector_dictionary">[docs]</a><span class="k">def</span> <span class="nf">RCD111_waveguide_vector_dictionary</span><span class="p">():</span>
  <span class="c1"># .. todo:: agree on single set of conventions + document it (+ add lyx doc to SIP repo?)</span>
  
  <span class="n">V</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
  <span class="n">V_groups</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
  <span class="p">(</span><span class="n">V_RCD</span><span class="p">,</span> <span class="n">V_groups_RCD</span><span class="p">)</span> <span class="o">=</span> <span class="n">RCD_vector_dictionary</span><span class="p">()</span>
  
  <span class="c1"># for i in V_groups_RCD[&#39;FCC-BZ-K-RCD111-1&#39;]:</span>
    <span class="c1"># print(i)</span>
  
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;b1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">V_RCD</span><span class="p">[</span><span class="s1">&#39;FCC-BZ-K-x-y-RCD111-1&#39;</span><span class="p">]</span>
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;b2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">V_RCD</span><span class="p">[</span><span class="s1">&#39;FCC-BZ-K-y-z-RCD111-1&#39;</span><span class="p">]</span>
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;b3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">V_RCD</span><span class="p">[</span><span class="s1">&#39;FCC-BZ-K-x-z-RCD111-1&#39;</span><span class="p">]</span>
  
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;m1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">V_RCD</span><span class="p">[</span><span class="s1">&#39;FCC-BZ-K-x+y-RCD111-2&#39;</span><span class="p">]</span>
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;m2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">V_RCD</span><span class="p">[</span><span class="s1">&#39;FCC-BZ-K-y+z-RCD111-2&#39;</span><span class="p">]</span>
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;m3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">V_RCD</span><span class="p">[</span><span class="s1">&#39;FCC-BZ-K-x+z-RCD111-2&#39;</span><span class="p">]</span>
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;m4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">V_RCD</span><span class="p">[</span><span class="s1">&#39;FCC-BZ-K+x-y-RCD111-2&#39;</span><span class="p">]</span>
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;m5&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">V_RCD</span><span class="p">[</span><span class="s1">&#39;FCC-BZ-K+y-z-RCD111-2&#39;</span><span class="p">]</span>
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;m6&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">V_RCD</span><span class="p">[</span><span class="s1">&#39;FCC-BZ-K+x-z-RCD111-2&#39;</span><span class="p">]</span>
  
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;t1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">V_RCD</span><span class="p">[</span><span class="s1">&#39;FCC-BZ-K+x+y-RCD111-1&#39;</span><span class="p">]</span>
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;t2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">V_RCD</span><span class="p">[</span><span class="s1">&#39;FCC-BZ-K+y+z-RCD111-1&#39;</span><span class="p">]</span>
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;t3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">V_RCD</span><span class="p">[</span><span class="s1">&#39;FCC-BZ-K+x+z-RCD111-1&#39;</span><span class="p">]</span>
  
  <span class="n">V_groups</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;t1&#39;</span><span class="p">,</span><span class="s1">&#39;t2&#39;</span><span class="p">,</span><span class="s1">&#39;t3&#39;</span><span class="p">)</span>
  <span class="n">V_groups</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;b1&#39;</span><span class="p">,</span><span class="s1">&#39;b2&#39;</span><span class="p">,</span><span class="s1">&#39;b3&#39;</span><span class="p">)</span>
  <span class="n">V_groups</span><span class="p">[</span><span class="s1">&#39;m&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;m1&#39;</span><span class="p">,</span><span class="s1">&#39;m2&#39;</span><span class="p">,</span><span class="s1">&#39;m3&#39;</span><span class="p">,</span><span class="s1">&#39;m4&#39;</span><span class="p">,</span><span class="s1">&#39;m5&#39;</span><span class="p">,</span><span class="s1">&#39;m6&#39;</span><span class="p">)</span>
  
  <span class="c1"># the 6 out of plane directions</span>
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;rcd111-up-1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span><span class="mi">1</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)])</span>
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;rcd111-up-2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">6</span><span class="p">)),</span> <span class="mi">1</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)])</span>
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;rcd111-up-3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">24</span><span class="p">),</span> <span class="mi">1</span><span class="o">/</span><span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)])</span>
  
  <span class="n">V_groups</span><span class="p">[</span><span class="s1">&#39;rcd111-up&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;rcd111-up-1&#39;</span><span class="p">,</span><span class="s1">&#39;rcd111-up-2&#39;</span><span class="p">,</span><span class="s1">&#39;rcd111-up-3&#39;</span><span class="p">)</span>
  
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;rcd111-down-1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">V</span><span class="p">[</span><span class="s1">&#39;rcd111-up-1&#39;</span><span class="p">]</span>
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;rcd111-down-2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">V</span><span class="p">[</span><span class="s1">&#39;rcd111-up-2&#39;</span><span class="p">]</span>
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;rcd111-down-3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">V</span><span class="p">[</span><span class="s1">&#39;rcd111-up-3&#39;</span><span class="p">]</span>
  
  <span class="n">V_groups</span><span class="p">[</span><span class="s1">&#39;rcd111-down&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;rcd111-down-1&#39;</span><span class="p">,</span><span class="s1">&#39;rcd111-down-2&#39;</span><span class="p">,</span><span class="s1">&#39;rcd111-down-3&#39;</span><span class="p">)</span>
  
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;rcd111-hex-1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;rcd111-hex-2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;rcd111-hex-3&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;rcd111-hex-4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;rcd111-hex-5&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;rcd111-hex-6&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
  
  <span class="n">V_groups</span><span class="p">[</span><span class="s1">&#39;rcd111-hex&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;rcd111-hex-1&#39;</span><span class="p">,</span> <span class="s1">&#39;rcd111-hex-2&#39;</span><span class="p">,</span> <span class="s1">&#39;rcd111-hex-3&#39;</span><span class="p">,</span> <span class="s1">&#39;rcd111-hex-4&#39;</span><span class="p">,</span> <span class="s1">&#39;rcd111-hex-5&#39;</span><span class="p">,</span> <span class="s1">&#39;rcd111-hex-6&#39;</span><span class="p">)</span>
  
  <span class="c1"># .. todo:: move into a more appropriate place... + add RCD111 transform basis</span>
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;cartesian-x&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;cartesian-y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
  <span class="n">V</span><span class="p">[</span><span class="s1">&#39;cartesian-z&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
  <span class="n">V_groups</span><span class="p">[</span><span class="s1">&#39;cartesian&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;cartesian-x&#39;</span><span class="p">,</span> <span class="s1">&#39;cartesian-y&#39;</span><span class="p">,</span> <span class="s1">&#39;cartesian-z&#39;</span><span class="p">)</span>
  
  <span class="k">return</span> <span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">V_groups</span><span class="p">)</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">script_inception_public  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2014, Mike Taverne.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.9.
    </div>
  </body>
</html>