Sphinx initial setup:
=====================

0) Run:

  MAINDIR=$HOME/Development/script_inception_public/

1) Check that all .py files are safe to process with autodoc by running:

  find ${MAINDIR} -type f -name "*.py" | xargs ack -lv "__main__"

The only files listed should be the ones auto-generated by pyuic and docs/conf.py.

2) Run:

  sphinx-apidoc --doc-project="script_inception_public"  -A "Mike Taverne" -F -o ${MAINDIR}/docs ${MAINDIR}

3) Remove script_inception_public. prefix:

  cd ${MAINDIR}/docs
  ls -1 script_inception_public.*rst | xargs -n1 -I{} sed -i 's/script_inception_public.//g' {}
  rename -v 's/script_inception_public\.//'  script_inception_public.*.rst

4) Remove blender_scripts due to missing modules (need to compile external Blender modules first)

  (cd ${MAINDIR}/docs && rm blender_scripts.io_mesh_BristolFDTD.rst blender_scripts.rst)

5) Remove blender_scripts line in script_inception_public.rst:

  sed -i '/blender_scripts/d' ${MAINDIR}/docs/script_inception_public.rst

6) Remove this in script_inception_public.rst:

  Module contents
  ---------------

  .. automodule:: script_inception_public
      :members:
      :undoc-members:
      :show-inheritance:

7) conf.py changes:

  sys.path.insert(0, os.path.abspath('..'))
  
  extensions = [
      'sphinx.ext.autodoc',
      'sphinx.ext.doctest',
      'sphinx.ext.todo',
      'sphinx.ext.coverage',
      'sphinx.ext.mathjax',
      'sphinx.ext.viewcode',
  ]

  todo_include_todos = True

  # If true, links to the reST sources are added to the pages.
  html_show_sourcelink = True

  # If true, "Created using Sphinx" is shown in the HTML footer. Default is True.
  html_show_sphinx = True

8) Makefile changes:

  SPHINXOPTS    = -w warnings.log

9) Add to index.rst:

  .. todolist::

10) Build the documentation and check for warnings:

  cd ${MAINDIR}/docs
  make clean html latexpdf && wc -l warnings.log

Sphinx doc update:
==================
Simple:
-------

  cd $HOME/Development/script_inception_public/docs && make clean html latexpdf && wc -l warnings.log

Full:
-----
-sphinx-apidoc -n -o ${MAINDIR}/docs ${MAINDIR}
-sphinx-apidoc -f -o ${MAINDIR}/docs ${MAINDIR}
-remove modules.rst
-rename the generated script_inception_public.MODULE.rst to MODULE.rst
-remove script_inception_public. in the new generated files

To build in another directory:
==============================

  cd $HOME/Development/script_inception_public/docs
  make BUILDDIR=${whereYouWantIt} clean html latexpdf

Example:

  make BUILDDIR=$HOME/gvfs_optics_git/documentation/ html latexpdf

Troubleshooting:
================
In case of problems, try a "make clean html".
It seems that "#" in verbatim sections sometimes cause problems when updating the doc for a module.

TODO:
=====
-Create a proper module, which can be installed with config.py and where no changes are needed to generate the documentation...
