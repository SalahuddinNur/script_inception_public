
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>bfdtd.GeometryObjects &#8212; script_inception_public  documentation</title>
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">script_inception_public  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for bfdtd.GeometryObjects</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># -*- coding: utf-8 -*-</span>

<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">Module containing the basic geometry objects available in BFDTD.</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">utilities</span>
<span class="kn">import</span> <span class="nn">utilities.geometry</span>

<span class="kn">from</span> <span class="nn">numpy.linalg</span> <span class="k">import</span> <span class="n">norm</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="k">import</span> <span class="n">array</span><span class="p">,</span> <span class="n">rad2deg</span><span class="p">,</span> <span class="n">cross</span><span class="p">,</span> <span class="n">dot</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">,</span> <span class="n">ceil</span><span class="p">,</span> <span class="n">deg2rad</span>
<span class="kn">from</span> <span class="nn">utilities.common</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">utilities.geometry</span>
<span class="kn">from</span> <span class="nn">.meshobject</span> <span class="k">import</span> <span class="n">MeshObject</span><span class="p">,</span> <span class="n">MeshingParameters</span>

<div class="viewcode-block" id="GeometryObject"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.GeometryObject">[docs]</a><span class="k">class</span> <span class="nc">GeometryObject</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
  <span class="c1"># .. todo:: rename permittivity, conductivity to relative permittivity, conductivity</span>
  <span class="c1"># .. todo:: finish implementing pre/post str() functions in other str() functions.</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">layer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">group</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">meshing_parameters</span> <span class="o">=</span> <span class="n">MeshingParameters</span><span class="p">()</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">permittivity</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1"># vacuum by default</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">conductivity</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">useForMeshing</span> <span class="o">=</span> <span class="kc">True</span> <span class="c1"># set to False to disable use of this object during automeshing</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">location</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span> <span class="c1"># TODO: Make all GeometryObject subclasses use this one. (i.e. centro-&gt;location)</span>
    
    <span class="c1">### rotation parameters</span>
    <span class="c1"># .. todo:: Yay, lot of ways of rotating... Fix this? Use single rotation matrix/quaternion/whatever, or a list of rotations?</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">rotation_list</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># .. todo:: implement quaternions?</span>
    <span class="c1">#self.rotation_quaternion = Quaternion()</span>
    
    <span class="c1"># temporary quick solution:</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">rotation_axis_angle</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># based on Blender defaults</span>
    
<div class="viewcode-block" id="GeometryObject.getName"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.GeometryObject.getName">[docs]</a>  <span class="k">def</span> <span class="nf">getName</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="GeometryObject.setName"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.GeometryObject.setName">[docs]</a>  <span class="k">def</span> <span class="nf">setName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
    <span class="k">return</span></div>
    
<div class="viewcode-block" id="GeometryObject.writeRotations"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.GeometryObject.writeRotations">[docs]</a>  <span class="k">def</span> <span class="nf">writeRotations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">FILE</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation_list</span><span class="p">:</span>
      <span class="n">r</span><span class="o">.</span><span class="n">write_entry</span><span class="p">(</span><span class="n">FILE</span><span class="p">)</span>
    <span class="k">return</span></div>
    
<div class="viewcode-block" id="GeometryObject.translate"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.GeometryObject.translate">[docs]</a>  <span class="k">def</span> <span class="nf">translate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vec3</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">location</span> <span class="o">+=</span> <span class="n">vec3</span>
    <span class="k">return</span></div>

<div class="viewcode-block" id="GeometryObject.rotate"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.GeometryObject.rotate">[docs]</a>  <span class="k">def</span> <span class="nf">rotate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis_point</span><span class="p">,</span> <span class="n">axis_direction</span><span class="p">,</span> <span class="n">angle_degrees</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">rotation_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Rotation</span><span class="p">(</span><span class="n">axis_point</span> <span class="o">=</span> <span class="n">axis_point</span><span class="p">,</span> <span class="n">axis_direction</span> <span class="o">=</span> <span class="n">axis_direction</span><span class="p">,</span> <span class="n">angle_degrees</span> <span class="o">=</span> <span class="n">angle_degrees</span><span class="p">))</span></div>
  
<div class="viewcode-block" id="GeometryObject.setRotationAxisAngle"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.GeometryObject.setRotationAxisAngle">[docs]</a>  <span class="k">def</span> <span class="nf">setRotationAxisAngle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rotation_axis_angle</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">rotation_axis_angle</span> <span class="o">=</span> <span class="n">rotation_axis_angle</span>
    <span class="k">return</span></div>
<div class="viewcode-block" id="GeometryObject.getRotationAxisAngle"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.GeometryObject.getRotationAxisAngle">[docs]</a>  <span class="k">def</span> <span class="nf">getRotationAxisAngle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rotation_axis_angle</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="GeometryObject.getRotationMatrix"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.GeometryObject.getRotationMatrix">[docs]</a>  <span class="k">def</span> <span class="nf">getRotationMatrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation_list</span><span class="p">:</span>
      <span class="n">R</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">getRotationMatrix</span><span class="p">(),</span> <span class="n">R</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">R</span><span class="p">)</span></div>

  <span class="k">def</span> <span class="nf">__pre_str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">ret</span>  <span class="o">=</span> <span class="s1">&#39;name = &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;permittivity = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">permittivity</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;conductivity = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conductivity</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;location = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="k">return</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">__post_str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="s1">&#39;---&gt;object rotation_list&#39;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rotation_list</span><span class="p">)):</span>
      <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
      <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;--&gt;object rotation &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;:</span><span class="se">\n</span><span class="s1">&#39;</span>
      <span class="n">ret</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span>
    <span class="k">return</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
  
  <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__pre_str__</span><span class="p">()</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">__post_str__</span><span class="p">()</span>
    <span class="k">return</span><span class="p">(</span><span class="n">ret</span><span class="p">)</span>
      
<div class="viewcode-block" id="GeometryObject.setRefractiveIndex"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.GeometryObject.setRefractiveIndex">[docs]</a>  <span class="k">def</span> <span class="nf">setRefractiveIndex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">permittivity</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span></div>

<div class="viewcode-block" id="GeometryObject.getRefractiveIndex"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.GeometryObject.getRefractiveIndex">[docs]</a>  <span class="k">def</span> <span class="nf">getRefractiveIndex</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">permittivity</span><span class="p">)</span></div>

<div class="viewcode-block" id="GeometryObject.setRelativePermittivity"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.GeometryObject.setRelativePermittivity">[docs]</a>  <span class="k">def</span> <span class="nf">setRelativePermittivity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">permittivity</span><span class="p">):</span>
    <span class="c1"># .. todo:: support diagonal/matrix permittivities like in MEEP... Warning: May break a lot of things...</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">permittivity</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">permittivity</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">permittivity</span> <span class="o">=</span> <span class="n">permittivity</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">permittivity</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># self.permittivity = 3*[permittivity]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">permittivity</span> <span class="o">=</span> <span class="n">permittivity</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">permittivity</span> <span class="o">=</span> <span class="n">permittivity</span>
    <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">permittivity</span><span class="p">)</span></div>
  
<div class="viewcode-block" id="GeometryObject.setRelativeConductivity"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.GeometryObject.setRelativeConductivity">[docs]</a>  <span class="k">def</span> <span class="nf">setRelativeConductivity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">conductivity</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">conductivity</span> <span class="o">=</span> <span class="n">conductivity</span></div>

<div class="viewcode-block" id="GeometryObject.getRelativePermittivity"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.GeometryObject.getRelativePermittivity">[docs]</a>  <span class="k">def</span> <span class="nf">getRelativePermittivity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">mean</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">permittivity</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
      <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">permittivity</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">permittivity</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">permittivity</span><span class="p">)</span></div>

<div class="viewcode-block" id="GeometryObject.getRelativeConductivity"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.GeometryObject.getRelativeConductivity">[docs]</a>  <span class="k">def</span> <span class="nf">getRelativeConductivity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conductivity</span><span class="p">)</span></div>

  <span class="c1"># this function requires the child objects to define a getCentro() and translate() method</span>
  <span class="c1"># TODO: It might make more sense to have each child object have its own setCentro function?</span>
  <span class="c1">#def setCentro(self, nova_centro):</span>
    <span class="c1">#nova_centro = numpy.array(nova_centro)    </span>
    <span class="c1">#nuna_centro = self.getCentro()</span>
    <span class="c1">#self.translate(nova_centro - nuna_centro)</span>
    
<div class="viewcode-block" id="GeometryObject.setLocation"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.GeometryObject.setLocation">[docs]</a>  <span class="k">def</span> <span class="nf">setLocation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">location</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">location</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>
    <span class="k">return</span></div>

<div class="viewcode-block" id="GeometryObject.getLocation"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.GeometryObject.getLocation">[docs]</a>  <span class="k">def</span> <span class="nf">getLocation</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="p">)</span></div>

<div class="viewcode-block" id="GeometryObject.getLowerAbsolute"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.GeometryObject.getLowerAbsolute">[docs]</a>  <span class="k">def</span> <span class="nf">getLowerAbsolute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="p">)</span> <span class="o">+</span> <span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getLowerRelative</span><span class="p">())</span> <span class="c1"># note that the plus sign is because getLowerRelative() already returns an &quot;algebraic vector&quot;</span></div>

<div class="viewcode-block" id="GeometryObject.getUpperAbsolute"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.GeometryObject.getUpperAbsolute">[docs]</a>  <span class="k">def</span> <span class="nf">getUpperAbsolute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="p">)</span> <span class="o">+</span> <span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getUpperRelative</span><span class="p">())</span></div>

<div class="viewcode-block" id="GeometryObject.getExtension"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.GeometryObject.getExtension">[docs]</a>  <span class="k">def</span> <span class="nf">getExtension</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">fixLowerUpper</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getLowerAbsolute</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">getUpperAbsolute</span><span class="p">())</span></div>

<div class="viewcode-block" id="GeometryObject.AABB_intersects"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.GeometryObject.AABB_intersects">[docs]</a>  <span class="k">def</span> <span class="nf">AABB_intersects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Returns true if the bounding box of the object intersects with the one of the object *obj*.&#39;&#39;&#39;</span>

    <span class="n">minBB_cyl</span><span class="p">,</span> <span class="n">maxBB_cyl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getAABB</span><span class="p">()</span>
    <span class="n">minBB_obj</span><span class="p">,</span> <span class="n">maxBB_obj</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">getAABB</span><span class="p">()</span>
    <span class="n">val</span> <span class="o">=</span> <span class="n">utilities</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">AABB_intersect</span><span class="p">(</span><span class="n">minBB_cyl</span><span class="p">,</span> <span class="n">maxBB_cyl</span><span class="p">,</span> <span class="n">minBB_obj</span><span class="p">,</span> <span class="n">maxBB_obj</span><span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">val</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="Sphere"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Sphere">[docs]</a><span class="k">class</span> <span class="nc">Sphere</span><span class="p">(</span><span class="n">GeometryObject</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">inner_radius</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">outer_radius</span> <span class="o">=</span> <span class="mf">0.5</span>
    
<div class="viewcode-block" id="Sphere.setOuterRadius"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Sphere.setOuterRadius">[docs]</a>  <span class="k">def</span> <span class="nf">setOuterRadius</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outer_radius</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">outer_radius</span> <span class="o">=</span> <span class="n">outer_radius</span>
    <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outer_radius</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="Sphere.setSize"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Sphere.setSize">[docs]</a>  <span class="k">def</span> <span class="nf">setSize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size_vec3</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;setSize wrapper for use in BFDTD export scripts&#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">setOuterRadius</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">size_vec3</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="c1"># We use the z-component because for the blender icospheres, it is the closest to the diametre used when creating them.</span></div>
  
<div class="viewcode-block" id="Sphere.setInnerRadius"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Sphere.setInnerRadius">[docs]</a>  <span class="k">def</span> <span class="nf">setInnerRadius</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inner_radius</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">inner_radius</span> <span class="o">=</span> <span class="n">inner_radius</span>
    <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inner_radius</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="Sphere.getOuterRadius"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Sphere.getOuterRadius">[docs]</a>  <span class="k">def</span> <span class="nf">getOuterRadius</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outer_radius</span><span class="p">)</span></div>
  
<div class="viewcode-block" id="Sphere.getInnerRadius"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Sphere.getInnerRadius">[docs]</a>  <span class="k">def</span> <span class="nf">getInnerRadius</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inner_radius</span><span class="p">)</span></div>

<div class="viewcode-block" id="Sphere.getSize"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Sphere.getSize">[docs]</a>  <span class="k">def</span> <span class="nf">getSize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; get the size of the sphere as an array of size 3 &#39;&#39;&#39;</span>
    <span class="n">d</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">getOuterRadius</span><span class="p">()</span>
    <span class="k">return</span><span class="p">([</span><span class="n">d</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">d</span><span class="p">])</span></div>

  <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">ret</span>  <span class="o">=</span> <span class="s1">&#39;name = &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;location = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span>\
    <span class="s1">&#39;outer_radius = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outer_radius</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span>\
    <span class="s1">&#39;inner_radius = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inner_radius</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span>\
    <span class="s1">&#39;permittivity = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">permittivity</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span>\
    <span class="s1">&#39;conductivity = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conductivity</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="n">GeometryObject</span><span class="o">.</span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ret</span>

<div class="viewcode-block" id="Sphere.read_entry"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Sphere.read_entry">[docs]</a>  <span class="k">def</span> <span class="nf">read_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">entry</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">location</span> <span class="o">=</span> <span class="n">float_array</span><span class="p">([</span><span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">outer_radius</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">inner_radius</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">permittivity</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">conductivity</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>
    <span class="k">return</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="Sphere.write_entry"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Sphere.write_entry">[docs]</a>  <span class="k">def</span> <span class="nf">write_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">FILE</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;BFDTD sphere object:</span>
<span class="sd">    </span>
<span class="sd">    * 1-5 Coordinates of the sphere ( xc yc zc r1 r2 )</span>
<span class="sd">    * 6 permittivity</span>
<span class="sd">    * 7 conductivity</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;SPHERE  **name=&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;{</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%E</span><span class="s2"> **XC</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%E</span><span class="s2"> **YC</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%E</span><span class="s2"> **ZC</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%E</span><span class="s2"> **outer_radius</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">outer_radius</span><span class="p">)</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%E</span><span class="s2"> **inner_radius</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_radius</span><span class="p">)</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:E}</span><span class="s2"> **relative permittivity -&gt; n=sqrt(mu_r*epsilon_r)=</span><span class="si">{:.2f}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">permittivity</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">permittivity</span><span class="p">)))</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%E</span><span class="s2"> **relative conductivity</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">conductivity</span><span class="p">)</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Sphere.writeCTL"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Sphere.writeCTL">[docs]</a>  <span class="k">def</span> <span class="nf">writeCTL</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">FILE</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])):</span>
    <span class="n">centro</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLocation</span><span class="p">()</span> <span class="o">+</span> <span class="n">offset</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;  (make sphere</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;    (material (make medium (epsilon </span><span class="si">{}</span><span class="s1">)) )</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getRelativePermittivity</span><span class="p">()))</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;    (center (vector3 </span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">) )</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">centro</span><span class="p">))</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;    (radius </span><span class="si">{}</span><span class="s1">)</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getOuterRadius</span><span class="p">()))</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;  )</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Sphere.getLowerRelative"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Sphere.getLowerRelative">[docs]</a>  <span class="k">def</span> <span class="nf">getLowerRelative</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">array</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="p">[</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">outer_radius</span><span class="p">])</span></div>

<div class="viewcode-block" id="Sphere.getUpperRelative"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Sphere.getUpperRelative">[docs]</a>  <span class="k">def</span> <span class="nf">getUpperRelative</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">array</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">outer_radius</span><span class="p">])</span></div></div>

<div class="viewcode-block" id="Block"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Block">[docs]</a><span class="k">class</span> <span class="nc">Block</span><span class="p">(</span><span class="n">GeometryObject</span><span class="p">):</span>
  <span class="sd">&#39;&#39;&#39; Create a Block. &#39;&#39;&#39;</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Constructor &#39;&#39;&#39;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    
    <span class="c1"># These are specified relative to location</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lower_relative</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="o">-</span><span class="mf">0.5</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">upper_relative</span> <span class="o">=</span> <span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">])</span>

  <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">ret</span>  <span class="o">=</span> <span class="s1">&#39;name = &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;lower_relative = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lower_relative</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;upper_relative = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">upper_relative</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;lower_absolute = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getLowerAbsolute</span><span class="p">())</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;upper_absolute = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getUpperAbsolute</span><span class="p">())</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;permittivity = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">permittivity</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;conductivity = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conductivity</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="n">GeometryObject</span><span class="o">.</span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ret</span>
    
<div class="viewcode-block" id="Block.read_entry"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Block.read_entry">[docs]</a>  <span class="k">def</span> <span class="nf">read_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entry</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;read an entry extracted from a .geo file&#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">name</span>
    <span class="n">lower_absolute</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">float_array</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]))</span>
    <span class="n">upper_absolute</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">float_array</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">]))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setLocation</span><span class="p">(</span> <span class="p">(</span><span class="n">array</span><span class="p">(</span><span class="n">lower_absolute</span><span class="p">)</span> <span class="o">+</span> <span class="n">array</span><span class="p">(</span><span class="n">upper_absolute</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span> <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setLowerAbsolute</span><span class="p">(</span><span class="n">lower_absolute</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setUpperAbsolute</span><span class="p">(</span><span class="n">upper_absolute</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">permittivity</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">conductivity</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">7</span><span class="p">])</span></div>
    
<div class="viewcode-block" id="Block.write_entry"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Block.write_entry">[docs]</a>  <span class="k">def</span> <span class="nf">write_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">FILE</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;write an entry to a file object&#39;&#39;&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lower_relative</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper_relative</span> <span class="o">=</span> <span class="n">fixLowerUpper</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lower_relative</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper_relative</span><span class="p">)</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;BLOCK **name=&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;{</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">L</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLowerAbsolute</span><span class="p">()</span>
    <span class="n">U</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getUpperAbsolute</span><span class="p">()</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%E</span><span class="s2"> **XL</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">L</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%E</span><span class="s2"> **YL</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">L</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%E</span><span class="s2"> **ZL</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">L</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%E</span><span class="s2"> **XU</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">U</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%E</span><span class="s2"> **YU</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">U</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%E</span><span class="s2"> **ZU</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">U</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:E}</span><span class="s2"> **relative permittivity -&gt; n=sqrt(mu_r*epsilon_r)=</span><span class="si">{:.2f}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">permittivity</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">permittivity</span><span class="p">)))</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%E</span><span class="s2"> **relative conductivity</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">conductivity</span><span class="p">)</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    
    <span class="c1">#print(self.rotation_axis_angle)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation_axis_angle</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
      <span class="n">rot</span> <span class="o">=</span> <span class="n">Rotation</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;_rotation&#39;</span><span class="p">,</span> <span class="n">axis_point</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getCentro</span><span class="p">(),</span> <span class="n">axis_direction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation_axis_angle</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">],</span> <span class="n">angle_degrees</span> <span class="o">=</span> <span class="n">rad2deg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rotation_axis_angle</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
      <span class="n">rot</span><span class="o">.</span><span class="n">write_entry</span><span class="p">(</span><span class="n">FILE</span><span class="p">)</span></div>
      
<div class="viewcode-block" id="Block.writeCTL"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Block.writeCTL">[docs]</a>  <span class="k">def</span> <span class="nf">writeCTL</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">FILE</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])):</span>
    <span class="n">centro</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLocation</span><span class="p">()</span> <span class="o">+</span> <span class="n">offset</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;  (make block</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;    (material (make medium (epsilon </span><span class="si">{}</span><span class="s1">)) )</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getRelativePermittivity</span><span class="p">()))</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;    (center (vector3 </span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">) )</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">centro</span><span class="p">))</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;    (size (vector3 </span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">) )</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">getSize</span><span class="p">()))</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;    (e1 (vector3 1 0 0))</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;    (e2 (vector3 0 1 0))</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;    (e3 (vector3 0 0 1))</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;  )</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span></div>
  
<div class="viewcode-block" id="Block.setLowerRelative"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Block.setLowerRelative">[docs]</a>  <span class="k">def</span> <span class="nf">setLowerRelative</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lower_relative</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lower_relative</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">lower_relative</span><span class="p">)</span></div>
  
<div class="viewcode-block" id="Block.setUpperRelative"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Block.setUpperRelative">[docs]</a>  <span class="k">def</span> <span class="nf">setUpperRelative</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">upper_relative</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">upper_relative</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">upper_relative</span><span class="p">)</span></div>

<div class="viewcode-block" id="Block.setLowerAbsolute"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Block.setLowerAbsolute">[docs]</a>  <span class="k">def</span> <span class="nf">setLowerAbsolute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lower_absolute</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lower_relative</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">lower_absolute</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">location</span></div>
  
<div class="viewcode-block" id="Block.setUpperAbsolute"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Block.setUpperAbsolute">[docs]</a>  <span class="k">def</span> <span class="nf">setUpperAbsolute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">upper_absolute</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">upper_relative</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">upper_absolute</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">location</span></div>
  
<div class="viewcode-block" id="Block.getLowerRelative"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Block.getLowerRelative">[docs]</a>  <span class="k">def</span> <span class="nf">getLowerRelative</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lower_relative</span><span class="p">)</span></div>

<div class="viewcode-block" id="Block.getUpperRelative"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Block.getUpperRelative">[docs]</a>  <span class="k">def</span> <span class="nf">getUpperRelative</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">upper_relative</span><span class="p">)</span></div>
        
<div class="viewcode-block" id="Block.getCentro"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Block.getCentro">[docs]</a>  <span class="k">def</span> <span class="nf">getCentro</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Returns the centre of the block (which can be different from its location).</span>
<span class="sd">    At the moment, the origin of a block can be arbitrarily defined, so keeping this around is useful.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">array</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getLowerAbsolute</span><span class="p">()</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">getUpperAbsolute</span><span class="p">()))</span></div>
  
<div class="viewcode-block" id="Block.setOriginToGeometry"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Block.setOriginToGeometry">[docs]</a>  <span class="k">def</span> <span class="nf">setOriginToGeometry</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Sets the origin of the block (i.e. the location) to the geometric centre of the block, without changing the absolute lower and upper coordinates. &#39;&#39;&#39;</span>
    <span class="n">lower_absolute</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLowerAbsolute</span><span class="p">()</span>
    <span class="n">upper_absolute</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getUpperAbsolute</span><span class="p">()</span>
    <span class="n">new_location</span> <span class="o">=</span> <span class="p">(</span><span class="n">lower_absolute</span> <span class="o">+</span> <span class="n">upper_absolute</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setSize</span><span class="p">(</span><span class="n">upper_absolute</span> <span class="o">-</span> <span class="n">lower_absolute</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setLocation</span><span class="p">(</span><span class="n">new_location</span><span class="p">)</span>
    <span class="k">return</span></div>
  
  <span class="c1">#def translate(self, vec3):</span>
    <span class="c1">#&#39;&#39;&#39;</span>
    <span class="c1">#.. todo:: translate should just change the location property and be the same for all objects. Redefine lower and upper when writing, etc. They should be relative.</span>
    <span class="c1">#&#39;&#39;&#39;</span>
    <span class="c1">#self.lower_relative = numpy.array(self.lower_relative)</span>
    <span class="c1">#self.upper_relative = numpy.array(self.upper_relative)</span>
    <span class="c1">#self.lower_relative = self.lower_relative + vec3</span>
    <span class="c1">#self.upper_relative = self.upper_relative + vec3</span>
  
<div class="viewcode-block" id="Block.getMeshingParameters"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Block.getMeshingParameters">[docs]</a>  <span class="k">def</span> <span class="nf">getMeshingParameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">xvec</span><span class="p">,</span><span class="n">yvec</span><span class="p">,</span><span class="n">zvec</span><span class="p">,</span><span class="n">epsx</span><span class="p">,</span><span class="n">epsy</span><span class="p">,</span><span class="n">epsz</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; get meshing parameters &#39;&#39;&#39;</span>
    <span class="n">objx</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sort</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">getLowerAbsolute</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">getUpperAbsolute</span><span class="p">()[</span><span class="mi">0</span><span class="p">]])</span>
    <span class="n">objy</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sort</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">getLowerAbsolute</span><span class="p">()[</span><span class="mi">1</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">getUpperAbsolute</span><span class="p">()[</span><span class="mi">1</span><span class="p">]])</span>
    <span class="n">objz</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sort</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">getLowerAbsolute</span><span class="p">()[</span><span class="mi">2</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">getUpperAbsolute</span><span class="p">()[</span><span class="mi">2</span><span class="p">]])</span>
    <span class="n">eps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">permittivity</span>
    <span class="n">xvec</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">xvec</span><span class="p">,</span><span class="n">objx</span><span class="p">])</span>
    <span class="n">yvec</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">yvec</span><span class="p">,</span><span class="n">objy</span><span class="p">])</span>
    <span class="n">zvec</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">zvec</span><span class="p">,</span><span class="n">objz</span><span class="p">])</span>
    <span class="n">epsx</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">epsx</span><span class="p">,</span><span class="n">eps</span><span class="p">])</span>
    <span class="n">epsy</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">epsy</span><span class="p">,</span><span class="n">eps</span><span class="p">])</span>
    <span class="n">epsz</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">epsz</span><span class="p">,</span><span class="n">eps</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">xvec</span><span class="p">,</span><span class="n">yvec</span><span class="p">,</span><span class="n">zvec</span><span class="p">,</span><span class="n">epsx</span><span class="p">,</span><span class="n">epsy</span><span class="p">,</span><span class="n">epsz</span></div>
    
<div class="viewcode-block" id="Block.getSize"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Block.getSize">[docs]</a>  <span class="k">def</span> <span class="nf">getSize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; get the size of the block as an array of size 3 &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getUpperRelative</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLowerRelative</span><span class="p">())</span></div>

<div class="viewcode-block" id="Block.setSize"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Block.setSize">[docs]</a>  <span class="k">def</span> <span class="nf">setSize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size_vec3</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; size_vec3 can be a vector of size 3 or a simple int or float (vector of size 1, scalar) &#39;&#39;&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lower_relative</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">size_vec3</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">upper_relative</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">size_vec3</span><span class="p">)</span>
    <span class="k">return</span></div>
  
<div class="viewcode-block" id="Block.getAABB"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Block.getAABB">[docs]</a>  <span class="k">def</span> <span class="nf">getAABB</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">      Returns the lower and upper corners of an Axis-Aligned Bounding Box (AABB) in absolute coordinates in the form **(minBB, maxBB)**, where *minBB = [xmin,ymin,zmin]* and *maxBB = [xmax,ymax,zmax]*.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getLowerAbsolute</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">getUpperAbsolute</span><span class="p">())</span></div>

<div class="viewcode-block" id="Block.getMEEPobject"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Block.getMEEPobject">[docs]</a>  <span class="k">def</span> <span class="nf">getMEEPobject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">meep</span>
    <span class="n">meep_block</span> <span class="o">=</span> <span class="n">meep</span><span class="o">.</span><span class="n">Block</span><span class="p">(</span> <span class="n">meep</span><span class="o">.</span><span class="n">Vector3</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">getSize</span><span class="p">()),</span>
                 <span class="n">center</span> <span class="o">=</span> <span class="n">meep</span><span class="o">.</span><span class="n">Vector3</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">getLocation</span><span class="p">()),</span>
                 <span class="n">material</span> <span class="o">=</span> <span class="n">meep</span><span class="o">.</span><span class="n">Medium</span><span class="p">(</span><span class="n">epsilon</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">getRelativePermittivity</span><span class="p">())</span> <span class="p">)</span>
    <span class="k">return</span><span class="p">(</span><span class="n">meep_block</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="Distorted"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Distorted">[docs]</a><span class="k">class</span> <span class="nc">Distorted</span><span class="p">(</span><span class="n">GeometryObject</span><span class="p">):</span>
  <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">  A cuboid object with arbitrary vertex positioning.</span>

<span class="sd">  .. image:: /images/distorted_vertices.png</span>
<span class="sd">     :align: center</span>
<span class="sd">  </span>
<span class="sd">  Vertex indices:</span>
<span class="sd">  </span>
<span class="sd">  * 0,1,2,3 = top face numbered clockwise viewed from outside</span>
<span class="sd">  * 4,5,6,7 = bottom face numbered clockwise viewed from outside</span>
<span class="sd">  </span>
<span class="sd">  Edges:</span>
<span class="sd">  </span>
<span class="sd">  * 3 connected to 4</span>
<span class="sd">  * 2 connected to 5</span>
<span class="sd">  * 0 connected to 7</span>
<span class="sd">  * 1 connected to 6</span>
<span class="sd">  </span>
<span class="sd">  Normal faces viewed from outside:</span>
<span class="sd">  </span>
<span class="sd">  * [3,2,1,0]</span>
<span class="sd">  * [7,6,5,4]</span>
<span class="sd">  * [0,1,6,7]</span>
<span class="sd">  * [1,2,5,6]</span>
<span class="sd">  * [2,3,4,5]</span>
<span class="sd">  * [3,0,7,4]  </span>
<span class="sd">  &#39;&#39;&#39;</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Constructor &#39;&#39;&#39;</span>
    <span class="n">GeometryObject</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    
    <span class="c1"># relative vertices</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">vertices_relative</span> <span class="o">=</span> <span class="n">array</span><span class="p">([[</span> <span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span>  <span class="mf">0.5</span><span class="p">],</span>
                              <span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span>  <span class="mf">0.5</span><span class="p">],</span>
                              <span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span>  <span class="mf">0.5</span><span class="p">,</span>  <span class="mf">0.5</span><span class="p">],</span>
                              <span class="p">[</span> <span class="mf">0.5</span><span class="p">,</span>  <span class="mf">0.5</span><span class="p">,</span>  <span class="mf">0.5</span><span class="p">],</span>
                              <span class="p">[</span> <span class="mf">0.5</span><span class="p">,</span>  <span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">],</span>
                              <span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span>  <span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">],</span>
                              <span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">],</span>
                              <span class="p">[</span> <span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">]])</span>

<div class="viewcode-block" id="Distorted.setVerticesRelative"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Distorted.setVerticesRelative">[docs]</a>  <span class="k">def</span> <span class="nf">setVerticesRelative</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vertices_relative</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Set relative coordinates of the object&#39;s vertices. &#39;&#39;&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">vertices_relative</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">vertices_relative</span><span class="p">)</span>
    <span class="c1">#self.vertices_relative = [ array(v) for v in vertices_relative ]</span>
    <span class="k">return</span></div>

<div class="viewcode-block" id="Distorted.setVerticesAbsolute"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Distorted.setVerticesAbsolute">[docs]</a>  <span class="k">def</span> <span class="nf">setVerticesAbsolute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vertices_absolute</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Set absolute coordinates of the object&#39;s vertices. &#39;&#39;&#39;</span>
    <span class="c1">#vertices_absolute = [ array(v) for v in vertices_absolute ]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">vertices_relative</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">vertices_absolute</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">location</span>
    <span class="k">return</span></div>
    
<div class="viewcode-block" id="Distorted.getVerticesRelative"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Distorted.getVerticesRelative">[docs]</a>  <span class="k">def</span> <span class="nf">getVerticesRelative</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Get relative coordinates of the object&#39;s vertices. &#39;&#39;&#39;</span>
    <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices_relative</span><span class="p">)</span></div>

<div class="viewcode-block" id="Distorted.getVerticesAbsolute"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Distorted.getVerticesAbsolute">[docs]</a>  <span class="k">def</span> <span class="nf">getVerticesAbsolute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Get absolute coordinates of the object&#39;s vertices. &#39;&#39;&#39;</span>
    <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices_relative</span><span class="p">)</span></div>
  
<div class="viewcode-block" id="Distorted.getCentroOfMassAbsolute"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Distorted.getCentroOfMassAbsolute">[docs]</a>  <span class="k">def</span> <span class="nf">getCentroOfMassAbsolute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Returns the &quot;centro of mass&quot; of the object, i.e. sum(vertices)/8. &#39;&#39;&#39;</span>
    <span class="n">vertices_absolute</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getVerticesAbsolute</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">vertices_absolute</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">vertices_absolute</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">vertices_absolute</span><span class="p">)</span></div>
    <span class="c1">#S = numpy.array([0,0,0])</span>
    <span class="c1">#for v in self.vertices_relative:</span>
      <span class="c1">#S = S + numpy.array(v)</span>
    <span class="c1">#return 1./len(self.vertices_relative)*S</span>
    
<div class="viewcode-block" id="Distorted.setOrigin"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Distorted.setOrigin">[docs]</a>  <span class="k">def</span> <span class="nf">setOrigin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">location</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Sets the location to the specified location, but so that the vertices keep the same absolute coordinates. This has no effect on BFDTD output, but is useful for placing objects. It is similar to changing the origin of an object in blender, while keeping the mesh in the same place.</span>
<span class="sd">    .. todo:: Rotations will complicate things here. May need to make sure it adapts the rotation accordingly.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">vertices_absolute</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getVerticesAbsolute</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setLocation</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVerticesAbsolute</span><span class="p">(</span><span class="n">vertices_absolute</span><span class="p">)</span>
    <span class="k">return</span></div>

<div class="viewcode-block" id="Distorted.setOriginToGeometry"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Distorted.setOriginToGeometry">[docs]</a>  <span class="k">def</span> <span class="nf">setOriginToGeometry</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Sets the origin of the object to its centro of mass.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setOrigin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getCentroOfMassAbsolute</span><span class="p">())</span>
    <span class="k">return</span></div>
  
  <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Returns a string object, so that print(object) prints useful information about the object instance. &#39;&#39;&#39;</span>
    <span class="c1">#ret  = &#39;name = &#39;+self.name+&#39;\n&#39;</span>
    <span class="c1">#ret += &#39;permittivity = &#39;+str(self.permittivity)+&#39;\n&#39;</span>
    <span class="c1">#ret += &#39;conductivity = &#39;+str(self.conductivity)+&#39;\n&#39;</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="n">GeometryObject</span><span class="o">.</span><span class="n">__pre_str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;vertices_relative = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices_relative</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="n">GeometryObject</span><span class="o">.</span><span class="n">__post_str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ret</span>
  
<div class="viewcode-block" id="Distorted.read_entry"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Distorted.read_entry">[docs]</a>  <span class="k">def</span> <span class="nf">read_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">entry</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Read a .geo file entry. &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">name</span>
      
    <span class="n">vertices_absolute</span> <span class="o">=</span> <span class="mi">8</span><span class="o">*</span><span class="p">[</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
      <span class="n">vertices_absolute</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">float_array</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="p">:</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">]))</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="n">vertices_absolute</span><span class="p">)</span>
    <span class="c1">#raise()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setVerticesAbsolute</span><span class="p">(</span><span class="n">vertices_absolute</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getCentroOfMassAbsolute</span><span class="p">())</span>
    <span class="c1">#raise()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setOriginToGeometry</span><span class="p">()</span>
      
    <span class="bp">self</span><span class="o">.</span><span class="n">permittivity</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">8</span><span class="o">*</span><span class="mi">3</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">conductivity</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">8</span><span class="o">*</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span></div>
    
<div class="viewcode-block" id="Distorted.write_entry"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Distorted.write_entry">[docs]</a>  <span class="k">def</span> <span class="nf">write_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">FILE</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Write a .geo file entry. &#39;&#39;&#39;</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;DISTORTED **name=&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;{</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">vertices_absolute</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getVerticesAbsolute</span><span class="p">()</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices_relative</span><span class="p">)):</span>
      <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%E</span><span class="s2"> **XV</span><span class="si">%d</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">vertices_absolute</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">i</span><span class="p">)</span> <span class="p">)</span>
      <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%E</span><span class="s2"> **YV</span><span class="si">%d</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">vertices_absolute</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">i</span><span class="p">)</span> <span class="p">)</span>
      <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%E</span><span class="s2"> **ZV</span><span class="si">%d</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">vertices_absolute</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span><span class="n">i</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:E}</span><span class="s2"> **relative permittivity -&gt; n=sqrt(mu_r*epsilon_r)=</span><span class="si">{:.2f}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">permittivity</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">permittivity</span><span class="p">)))</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%E</span><span class="s2"> **relative conductivity</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">conductivity</span><span class="p">)</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span></div>
    
  <span class="c1">#def translate(self, vec3):</span>
    <span class="c1">#for i in range(len(self.vertices_relative)):</span>
      <span class="c1">#self.vertices_relative[i] = numpy.array(self.vertices_relative[i]) + numpy.array(vec3)</span>
      
<div class="viewcode-block" id="Distorted.getMeshingParameters"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Distorted.getMeshingParameters">[docs]</a>  <span class="k">def</span> <span class="nf">getMeshingParameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">xvec</span><span class="p">,</span><span class="n">yvec</span><span class="p">,</span><span class="n">zvec</span><span class="p">,</span><span class="n">epsx</span><span class="p">,</span><span class="n">epsy</span><span class="p">,</span><span class="n">epsz</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; todo:: improve meshing system + add support for rotations &#39;&#39;&#39;</span>
    
    <span class="c1"># determine lower and upper points of distorted object</span>
    <span class="n">vertex_min</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices_relative</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">vertex_max</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vertices_relative</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">vertex</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vertices_relative</span><span class="p">:</span>
      <span class="c1">#print(&#39;vertex = &#39;+str(vertex))</span>
      <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">vertex</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&lt;</span><span class="n">vertex_min</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span> <span class="n">vertex_min</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">vertex</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">vertex</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;</span><span class="n">vertex_max</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span> <span class="n">vertex_max</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">vertex</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    
    <span class="c1">#print(&#39;vertex_min = &#39;+str(vertex_min))</span>
    <span class="c1">#print(&#39;vertex_max = &#39;+str(vertex_max))</span>
    
    <span class="n">objx</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sort</span><span class="p">([</span><span class="n">vertex_min</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">vertex_max</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
    <span class="n">objy</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sort</span><span class="p">([</span><span class="n">vertex_min</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">vertex_max</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
    <span class="n">objz</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sort</span><span class="p">([</span><span class="n">vertex_min</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">vertex_max</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
    <span class="n">eps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">permittivity</span>
    <span class="n">xvec</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">xvec</span><span class="p">,</span><span class="n">objx</span><span class="p">])</span>
    <span class="n">yvec</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">yvec</span><span class="p">,</span><span class="n">objy</span><span class="p">])</span>
    <span class="n">zvec</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">zvec</span><span class="p">,</span><span class="n">objz</span><span class="p">])</span>
    <span class="n">epsx</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">epsx</span><span class="p">,</span><span class="n">eps</span><span class="p">])</span>
    <span class="n">epsy</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">epsy</span><span class="p">,</span><span class="n">eps</span><span class="p">])</span>
    <span class="n">epsz</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">epsz</span><span class="p">,</span><span class="n">eps</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">xvec</span><span class="p">,</span><span class="n">yvec</span><span class="p">,</span><span class="n">zvec</span><span class="p">,</span><span class="n">epsx</span><span class="p">,</span><span class="n">epsy</span><span class="p">,</span><span class="n">epsz</span></div></div>

<div class="viewcode-block" id="Parallelepiped"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Parallelepiped">[docs]</a><span class="k">class</span> <span class="nc">Parallelepiped</span><span class="p">(</span><span class="n">Distorted</span><span class="p">):</span>
  <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">  A parallelepiped (i.e., a brick, possibly with non-orthogonal axes).</span>
<span class="sd">  </span>
<span class="sd">  Properties:</span>
<span class="sd">  </span>
<span class="sd">  * location [vector3]: Center point of the object. default value: [0,0,0]</span>
<span class="sd">  * size [vector3]: The lengths of the block edges along each of its three axes. Not really a 3-vector, but it has three components, each of which should be nonzero. default value: [1,1,1]</span>
<span class="sd">  * e0, e1, e2 [vector3]: The directions of the axes of the block; the lengths of these vectors are ignored. Must be linearly independent. They default to the three lattice directions. </span>
<span class="sd">  </span>
<span class="sd">  .. todo:: This should be merged with the GWL Parallelepiped.</span>
<span class="sd">    And we should add a GWL writing system to Distorted.</span>
<span class="sd">    idea: objects are as general as possible, following CAD-like standards/systems. They then just get extended with special read/write functions depending on the application.</span>
<span class="sd">    </span>
<span class="sd">  .. todo:: Think about class design a bit more... parallepiped, block, distorted, ellipsoid...</span>
<span class="sd">  &#39;&#39;&#39;</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Constructor &#39;&#39;&#39;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">e0</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">e1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">e2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">updateVertices</span><span class="p">()</span>
    <span class="k">return</span>
  
  <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Returns a string object, so that print(object) prints useful information about the object instance. &#39;&#39;&#39;</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="n">GeometryObject</span><span class="o">.</span><span class="n">__pre_str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;e0 = </span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">e0</span><span class="p">)</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;e1 = </span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">e1</span><span class="p">)</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;e2 = </span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">e2</span><span class="p">)</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;size = </span><span class="si">{}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="n">GeometryObject</span><span class="o">.</span><span class="n">__post_str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ret</span>

<div class="viewcode-block" id="Parallelepiped.setSize"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Parallelepiped.setSize">[docs]</a>  <span class="k">def</span> <span class="nf">setSize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">size</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">updateVertices</span><span class="p">()</span></div>
    
<div class="viewcode-block" id="Parallelepiped.getSize"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Parallelepiped.getSize">[docs]</a>  <span class="k">def</span> <span class="nf">getSize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span></div>
  
<div class="viewcode-block" id="Parallelepiped.setAxes"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Parallelepiped.setAxes">[docs]</a>  <span class="k">def</span> <span class="nf">setAxes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">e1</span><span class="p">,</span> <span class="n">e2</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">e0</span> <span class="o">=</span> <span class="n">e0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">e1</span> <span class="o">=</span> <span class="n">e1</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">e2</span> <span class="o">=</span> <span class="n">e2</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">updateVertices</span><span class="p">()</span>
    <span class="k">return</span></div>
    
<div class="viewcode-block" id="Parallelepiped.getAxes"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Parallelepiped.getAxes">[docs]</a>  <span class="k">def</span> <span class="nf">getAxes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">e0</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">e1</span><span class="p">),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">e2</span><span class="p">))</span></div>
    
<div class="viewcode-block" id="Parallelepiped.updateVertices"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Parallelepiped.updateVertices">[docs]</a>  <span class="k">def</span> <span class="nf">updateVertices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setDirectionsAndSize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">e0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">e1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">e2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="Parallelepiped.setDirectionsAndSize"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Parallelepiped.setDirectionsAndSize">[docs]</a>  <span class="k">def</span> <span class="nf">setDirectionsAndSize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e0</span><span class="p">,</span> <span class="n">e1</span><span class="p">,</span> <span class="n">e2</span><span class="p">,</span> <span class="n">size</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    .. todo:: There is no protection against an &quot;inverted cuboid&quot; at the moment.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">e0</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">e0</span><span class="p">)</span>
    <span class="n">e1</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">e1</span><span class="p">)</span>
    <span class="n">e2</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">e2</span><span class="p">)</span>
    
    <span class="n">u0</span> <span class="o">=</span> <span class="n">size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">e0</span><span class="o">/</span><span class="n">norm</span><span class="p">(</span><span class="n">e0</span><span class="p">)</span>
    <span class="n">u1</span> <span class="o">=</span> <span class="n">size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">e1</span><span class="o">/</span><span class="n">norm</span><span class="p">(</span><span class="n">e1</span><span class="p">)</span>
    <span class="n">u2</span> <span class="o">=</span> <span class="n">size</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">e2</span><span class="o">/</span><span class="n">norm</span><span class="p">(</span><span class="n">e2</span><span class="p">)</span>

    <span class="n">v_list</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.5</span><span class="p">,</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">],[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">],[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">],[</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">],[</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="o">-</span><span class="mf">0.5</span><span class="p">],[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="o">-</span><span class="mf">0.5</span><span class="p">],[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="o">-</span><span class="mf">0.5</span><span class="p">],[</span><span class="mf">0.5</span><span class="p">,</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="o">-</span><span class="mf">0.5</span><span class="p">]]</span>
    
    <span class="n">v_list_new</span> <span class="o">=</span> <span class="p">[</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">u0</span> <span class="o">+</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">u1</span> <span class="o">+</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">u2</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">v_list</span><span class="p">]</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">setVerticesRelative</span><span class="p">(</span><span class="n">v_list_new</span><span class="p">)</span>
    <span class="k">return</span></div></div>

<div class="viewcode-block" id="Ellipsoid"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Ellipsoid">[docs]</a><span class="k">class</span> <span class="nc">Ellipsoid</span><span class="p">(</span><span class="n">Parallelepiped</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Constructor &#39;&#39;&#39;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span></div>

<div class="viewcode-block" id="Cylinder"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Cylinder">[docs]</a><span class="k">class</span> <span class="nc">Cylinder</span><span class="p">(</span><span class="n">GeometryObject</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
    <span class="n">inner_radius</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">outer_radius</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">height</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">angle_deg</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>

    <span class="k">if</span> <span class="n">inner_radius</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">inner_radius</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">outer_radius</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">outer_radius</span> <span class="o">=</span> <span class="mf">0.5</span>
    <span class="k">if</span> <span class="n">height</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">angle_deg</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">angle_deg</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="nb">super</span><span class="p">(</span><span class="n">Cylinder</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span> <span class="c1"># python 2+3 compatible super() call</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">inner_radius</span> <span class="o">=</span> <span class="n">inner_radius</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">outer_radius</span> <span class="o">=</span> <span class="n">outer_radius</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="n">height</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">angle_deg</span> <span class="o">=</span> <span class="n">angle_deg</span>
    
    <span class="c1"># quick hack to make life easy</span>
    <span class="c1">#self.axis = array([0,1,0])</span>
  
<div class="viewcode-block" id="Cylinder.getCentro"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Cylinder.getCentro">[docs]</a>  <span class="k">def</span> <span class="nf">getCentro</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;WARNING: getCentro() is deprecated. Please use getLocation() instead.&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLocation</span><span class="p">()</span></div>

<div class="viewcode-block" id="Cylinder.setSize"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Cylinder.setSize">[docs]</a>  <span class="k">def</span> <span class="nf">setSize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dimensions</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; sets size from a 3d vector of the form [2*outer_radius, 2*outer_radius, height] (if the first 2 values are different, it takes the maximum) &#39;&#39;&#39;</span>
    <span class="c1"># TODO: inner radius? (Problem: this is used by the current BFDTD export prototype and supposed to be the same for all objects.)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">outer_radius</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="nb">max</span><span class="p">(</span><span class="n">dimensions</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">dimensions</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="n">dimensions</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span></div>
  
  <span class="c1"># deprecated old functions</span>
  <span class="c1">#def getLower(self):</span>
    <span class="c1">#return [self.location[0]-self.outer_radius,self.location[1]-0.5*self.height,self.location[2]-self.outer_radius]</span>
  
  <span class="c1">#def getUpper(self):</span>
    <span class="c1">#return [self.location[0]+self.outer_radius,self.location[1]+0.5*self.height,self.location[2]+self.outer_radius]</span>
  
  <span class="c1"># .. todo:: Make these functions return the bounding box values!!! (AABB + non-AABB values?)</span>
<div class="viewcode-block" id="Cylinder.getLowerRelative"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Cylinder.getLowerRelative">[docs]</a>  <span class="k">def</span> <span class="nf">getLowerRelative</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">      Returns the lower corner of an Axis-Aligned Bounding Box (AABB) in coordinates relative to the location (centre of the cylinder).</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1">#return array([-self.outer_radius, -0.5*self.height, -self.outer_radius])</span>
    <span class="p">(</span><span class="n">minBB</span><span class="p">,</span> <span class="n">maxBB</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getAABB</span><span class="p">()</span>
    <span class="k">return</span><span class="p">(</span><span class="n">minBB</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLocation</span><span class="p">())</span></div>

<div class="viewcode-block" id="Cylinder.getUpperRelative"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Cylinder.getUpperRelative">[docs]</a>  <span class="k">def</span> <span class="nf">getUpperRelative</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">      Returns the upper corner of an Axis-Aligned Bounding Box (AABB) in coordinates relative to the location (centre of the cylinder).</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1">#return array([self.outer_radius, 0.5*self.height, self.outer_radius])</span>
    <span class="p">(</span><span class="n">minBB</span><span class="p">,</span> <span class="n">maxBB</span><span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getAABB</span><span class="p">()</span>
    <span class="k">return</span><span class="p">(</span><span class="n">maxBB</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLocation</span><span class="p">())</span></div>
  
<div class="viewcode-block" id="Cylinder.getAABB"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Cylinder.getAABB">[docs]</a>  <span class="k">def</span> <span class="nf">getAABB</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">      Returns the lower and upper corners of an Axis-Aligned Bounding Box (AABB) in absolute coordinates in the form **(minBB, maxBB)**, where *minBB = [xmin,ymin,zmin]* and *maxBB = [xmax,ymax,zmax]*.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">start_point</span><span class="p">,</span> <span class="n">end_point</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getStartEndPoints</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">utilities</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">getAABBCylinder</span><span class="p">(</span><span class="n">start_point</span><span class="p">,</span> <span class="n">end_point</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">getOuterRadius</span><span class="p">())</span></div>

<div class="viewcode-block" id="Cylinder.setDiametre"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Cylinder.setDiametre">[docs]</a>  <span class="k">def</span> <span class="nf">setDiametre</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">diametre</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">outer_radius</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">diametre</span></div>

  <span class="c1"># TODO: Implement inner/outer radius visualization, check it actually works in Bristol FDTD</span>
  
<div class="viewcode-block" id="Cylinder.setInnerRadius"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Cylinder.setInnerRadius">[docs]</a>  <span class="k">def</span> <span class="nf">setInnerRadius</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inner_radius</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">inner_radius</span> <span class="o">=</span> <span class="n">inner_radius</span></div>
<div class="viewcode-block" id="Cylinder.getInnerRadius"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Cylinder.getInnerRadius">[docs]</a>  <span class="k">def</span> <span class="nf">getInnerRadius</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inner_radius</span><span class="p">)</span></div>

<div class="viewcode-block" id="Cylinder.setOuterRadius"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Cylinder.setOuterRadius">[docs]</a>  <span class="k">def</span> <span class="nf">setOuterRadius</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outer_radius</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">outer_radius</span> <span class="o">=</span> <span class="n">outer_radius</span></div>
<div class="viewcode-block" id="Cylinder.getOuterRadius"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Cylinder.getOuterRadius">[docs]</a>  <span class="k">def</span> <span class="nf">getOuterRadius</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outer_radius</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="Cylinder.setHeight"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Cylinder.setHeight">[docs]</a>  <span class="k">def</span> <span class="nf">setHeight</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">height</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="n">height</span></div>
<div class="viewcode-block" id="Cylinder.getHeight"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Cylinder.getHeight">[docs]</a>  <span class="k">def</span> <span class="nf">getHeight</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">)</span></div>

<div class="viewcode-block" id="Cylinder.getAxis"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Cylinder.getAxis">[docs]</a>  <span class="k">def</span> <span class="nf">getAxis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1"># TODO</span>
    <span class="c1"># quick hack to make life easy</span>
    <span class="c1">#return(self.axis)</span>
    <span class="c1"># .. todo:: fix NaN returns if axis = Y axis for example</span>
    
    <span class="n">rotation_axis_angle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getRotationAxisAngle</span><span class="p">()</span>
    <span class="n">angle_radians</span> <span class="o">=</span> <span class="n">rotation_axis_angle</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">axis_direction</span> <span class="o">=</span> <span class="n">rotation_axis_angle</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>
    
    <span class="c1"># hack because when we write, we use both rotation systems at the moment... :/</span>
    
    <span class="c1"># first rotation using a single axis/angle definition</span>
    <span class="n">R1</span> <span class="o">=</span> <span class="n">rotation_matrix3</span><span class="p">(</span><span class="n">axis_direction</span><span class="p">,</span> <span class="n">angle_radians</span><span class="p">)</span>
    <span class="n">cylinder_axis</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">R1</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
    
    <span class="c1"># second rotation using the BFDTD rotation list system</span>
    <span class="n">R2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getRotationMatrix</span><span class="p">()</span>
    <span class="n">cylinder_axis</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">R2</span><span class="p">,</span> <span class="n">cylinder_axis</span><span class="p">)</span>
    
    <span class="k">return</span><span class="p">(</span> <span class="n">utilities</span><span class="o">.</span><span class="n">common</span><span class="o">.</span><span class="n">unitVector</span><span class="p">(</span><span class="n">cylinder_axis</span><span class="p">)</span> <span class="p">)</span></div>

<div class="viewcode-block" id="Cylinder.setAxis"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Cylinder.setAxis">[docs]</a>  <span class="k">def</span> <span class="nf">setAxis</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis_vec3</span><span class="p">):</span>
    
    <span class="c1"># quick hack to make life easy</span>
    <span class="c1">#self.axis = axis_vec3</span>
    
    <span class="n">angle_radians</span> <span class="o">=</span> <span class="n">Angle</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">axis_vec3</span><span class="p">)</span>
    <span class="n">axis_direction</span> <span class="o">=</span> <span class="n">cross</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">axis_vec3</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">axis_direction</span><span class="p">,</span> <span class="n">axis_direction</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">angle_radians</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setRotationAxisAngle</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setRotationAxisAngle</span><span class="p">([</span><span class="n">numpy</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">setRotationAxisAngle</span><span class="p">([</span><span class="n">angle_radians</span><span class="p">,</span> <span class="n">axis_direction</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">axis_direction</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">axis_direction</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>

    <span class="k">return</span></div>

<div class="viewcode-block" id="Cylinder.setStartEndPoints"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Cylinder.setStartEndPoints">[docs]</a>  <span class="k">def</span> <span class="nf">setStartEndPoints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_point_vec3</span><span class="p">,</span> <span class="n">end_point_vec3</span><span class="p">):</span>
    <span class="n">start_point_vec3</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">start_point_vec3</span><span class="p">)</span>
    <span class="n">end_point_vec3</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="n">end_point_vec3</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">setAxis</span><span class="p">(</span><span class="n">end_point_vec3</span> <span class="o">-</span> <span class="n">start_point_vec3</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">end_point_vec3</span> <span class="o">-</span> <span class="n">start_point_vec3</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">location</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">start_point_vec3</span> <span class="o">+</span> <span class="n">end_point_vec3</span><span class="p">)</span>
    <span class="k">return</span></div>
    
<div class="viewcode-block" id="Cylinder.getStartEndPoints"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Cylinder.getStartEndPoints">[docs]</a>  <span class="k">def</span> <span class="nf">getStartEndPoints</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">A</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLocation</span><span class="p">()</span> <span class="o">-</span> <span class="mf">0.5</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">getHeight</span><span class="p">()</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">getAxis</span><span class="p">()</span>
    <span class="n">B</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLocation</span><span class="p">()</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">getHeight</span><span class="p">()</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">getAxis</span><span class="p">()</span>
    <span class="k">return</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">)</span></div>
  
  <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">ret</span>  <span class="o">=</span> <span class="s1">&#39;name = &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;centro = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span>\
    <span class="s1">&#39;inner_radius = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inner_radius</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span>\
    <span class="s1">&#39;outer_radius = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outer_radius</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span>\
    <span class="s1">&#39;height = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span>\
    <span class="s1">&#39;permittivity = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">permittivity</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span>\
    <span class="s1">&#39;conductivity = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conductivity</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span>\
    <span class="s1">&#39;angle_deg = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angle_deg</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span>\
    <span class="s1">&#39;axis = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getAxis</span><span class="p">())</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="n">GeometryObject</span><span class="o">.</span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ret</span>
  
<div class="viewcode-block" id="Cylinder.read_entry"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Cylinder.read_entry">[docs]</a>  <span class="k">def</span> <span class="nf">read_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">entry</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">location</span> <span class="o">=</span> <span class="n">float_array</span><span class="p">([</span><span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">inner_radius</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">outer_radius</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">height</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">permittivity</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">conductivity</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">7</span><span class="p">])</span>
    <span class="k">if</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">8</span><span class="p">):</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle_deg</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">8</span><span class="p">])</span>
    <span class="k">return</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span></div>
  
  <span class="c1">#def computeRotationObjects(self):</span>
    <span class="c1">#rotation_objects = []</span>

    <span class="c1">#Rotation(name = &#39;cylinder_rotation&#39;,</span>
      <span class="c1">#axis_point = self.location,</span>
      <span class="c1">#axis_direction = cross([0,1,0],self.axis),</span>
      <span class="c1">#angle_degrees = rad2deg(Angle([0,1,0],self.axis)))</span>

    <span class="c1">#return rotation_objects</span>
    
  <span class="c1"># TODO: disable the old self.angle_deg parameter to avoid conflicts with rotation? But first find out how BFDTD handles it + discuss with Chris Railton.</span>
<div class="viewcode-block" id="Cylinder.write_entry"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Cylinder.write_entry">[docs]</a>  <span class="k">def</span> <span class="nf">write_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">FILE</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    cylinder</span>
<span class="sd">    {</span>
<span class="sd">    1-7 Coordinates of the material volume ( xc yc zc r1 r2 h )</span>
<span class="sd">    7 permittivity</span>
<span class="sd">    8 conductivity</span>
<span class="sd">    9 angle_deg of inclination</span>
<span class="sd">    }</span>
<span class="sd">    </span>
<span class="sd">    * xc, yc and zc are the coordinates of the centro of the cylinder. r1 and r2 are the inner and outer radius respectively</span>
<span class="sd">    * h is the cylinder height</span>
<span class="sd">    * angle_deg is the angle of inclination in degrees</span>
<span class="sd">      The cylinder is aligned with the y direction if =0 and with the x direction if =90</span>
<span class="sd">      i.e. angle_deg = Angle of rotation in degrees around -Z=(0,0,-1)</span>
<span class="sd">    &#39;&#39;&#39;</span>
  
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;CYLINDER **name=&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;{</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%E</span><span class="s2"> **X centro</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%E</span><span class="s2"> **Y centro</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%E</span><span class="s2"> **Z centro</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%E</span><span class="s2"> **inner_radius</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">inner_radius</span><span class="p">)</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%E</span><span class="s2"> **outer_radius</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">outer_radius</span><span class="p">)</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%E</span><span class="s2"> **height</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:E}</span><span class="s2"> **relative permittivity -&gt; n=sqrt(mu_r*epsilon_r)=</span><span class="si">{:.2f}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">permittivity</span><span class="p">,</span> <span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">permittivity</span><span class="p">)))</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%E</span><span class="s2"> **relative conductivity</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">conductivity</span><span class="p">)</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%E</span><span class="s2"> **angle of rotation in degrees around -Z=(0,0,-1)</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle_deg</span><span class="p">)</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    
    <span class="c1">#angle_degrees = rad2deg(Angle([0,1,0],self.axis))</span>
    <span class="c1">#if angle_degrees != 0:</span>
      <span class="c1">#rot = Rotation(name = &#39;cylinder_rotation&#39;, axis_point = self.location, axis_direction = cross([0,1,0],self.axis), angle_degrees = angle_degrees)</span>
      <span class="c1">#rot.write_entry(FILE)</span>
    
    <span class="c1"># TODO: BFDTD cylinders are along the Y axis by default, so rotation_axis_angle needs to be adapted for that... Just rotate back to Y first?</span>
    <span class="c1">#print(self.rotation_axis_angle)</span>
    <span class="c1"># HACK: We just always rotate for now. Adding the custom BFDTD object adder in Blender should fix this (but then for MPB/MEEP/etc... :/ )</span>
    <span class="c1">#rot = Rotation(name = self.name+&#39;_rotation&#39;, axis_point = self.getCentro(), axis_direction = [1,0,0], angle_degrees = -90)</span>
    <span class="c1">#rot.write_entry(FILE)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation_axis_angle</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
      <span class="n">rot</span> <span class="o">=</span> <span class="n">Rotation</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;_rotation&#39;</span><span class="p">,</span> <span class="n">axis_point</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLocation</span><span class="p">(),</span> <span class="n">axis_direction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotation_axis_angle</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">],</span> <span class="n">angle_degrees</span> <span class="o">=</span> <span class="n">rad2deg</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">rotation_axis_angle</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
      <span class="n">rot</span><span class="o">.</span><span class="n">write_entry</span><span class="p">(</span><span class="n">FILE</span><span class="p">)</span>
      
    <span class="bp">self</span><span class="o">.</span><span class="n">writeRotations</span><span class="p">(</span><span class="n">FILE</span><span class="p">)</span></div>

  <span class="c1"># TODO: take inner_radius into account, create 4 square meshing regions, implement per object meshing finesse (for all object types)</span>
<div class="viewcode-block" id="Cylinder.getMeshingParameters"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Cylinder.getMeshingParameters">[docs]</a>  <span class="k">def</span> <span class="nf">getMeshingParameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">xvec</span><span class="p">,</span><span class="n">yvec</span><span class="p">,</span><span class="n">zvec</span><span class="p">,</span><span class="n">epsx</span><span class="p">,</span><span class="n">epsy</span><span class="p">,</span><span class="n">epsz</span><span class="p">):</span>
    <span class="n">objx</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sort</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">outer_radius</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">outer_radius</span><span class="p">])</span>
    <span class="n">objy</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sort</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">])</span>
    <span class="n">objz</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sort</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">outer_radius</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">location</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">outer_radius</span><span class="p">])</span>
    <span class="n">eps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">permittivity</span>
    <span class="n">xvec</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">xvec</span><span class="p">,</span><span class="n">objx</span><span class="p">])</span>
    <span class="n">yvec</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">yvec</span><span class="p">,</span><span class="n">objy</span><span class="p">])</span>
    <span class="n">zvec</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">zvec</span><span class="p">,</span><span class="n">objz</span><span class="p">])</span>
    <span class="n">epsx</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">epsx</span><span class="p">,</span><span class="n">eps</span><span class="p">])</span>
    <span class="n">epsy</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">epsy</span><span class="p">,</span><span class="n">eps</span><span class="p">])</span>
    <span class="n">epsz</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">epsz</span><span class="p">,</span><span class="n">eps</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">xvec</span><span class="p">,</span><span class="n">yvec</span><span class="p">,</span><span class="n">zvec</span><span class="p">,</span><span class="n">epsx</span><span class="p">,</span><span class="n">epsy</span><span class="p">,</span><span class="n">epsz</span></div>
    
<div class="viewcode-block" id="Cylinder.getSize"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Cylinder.getSize">[docs]</a>  <span class="k">def</span> <span class="nf">getSize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c1"># TODO: Take rotations into account?</span>
    <span class="k">return</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">outer_radius</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">height</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">outer_radius</span><span class="p">])</span></div>
    
<div class="viewcode-block" id="Cylinder.writeCTL"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Cylinder.writeCTL">[docs]</a>  <span class="k">def</span> <span class="nf">writeCTL</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">FILE</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])):</span>
    <span class="n">centro</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getLocation</span><span class="p">()</span> <span class="o">+</span> <span class="n">offset</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;  (make cylinder</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;    (material (make medium (epsilon </span><span class="si">{}</span><span class="s1">)) )</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getRelativePermittivity</span><span class="p">()))</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;    (center (vector3 </span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">) )</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">centro</span><span class="p">))</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;    (radius </span><span class="si">{}</span><span class="s1">)</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getOuterRadius</span><span class="p">()))</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;    (height </span><span class="si">{}</span><span class="s1">)</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getHeight</span><span class="p">()))</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;    (axis (vector3 </span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">) )</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">getAxis</span><span class="p">()))</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;  )</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Cylinder.getMEEPobject"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Cylinder.getMEEPobject">[docs]</a>  <span class="k">def</span> <span class="nf">getMEEPobject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="kn">import</span> <span class="nn">meep</span>
    <span class="n">meep_cylinder</span> <span class="o">=</span> <span class="n">meep</span><span class="o">.</span><span class="n">Cylinder</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getOuterRadius</span><span class="p">(),</span>
        <span class="n">axis</span><span class="o">=</span><span class="n">meep</span><span class="o">.</span><span class="n">Vector3</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">getAxis</span><span class="p">()),</span>
        <span class="n">height</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">getHeight</span><span class="p">(),</span>
        <span class="n">material</span><span class="o">=</span><span class="n">meep</span><span class="o">.</span><span class="n">Medium</span><span class="p">(</span><span class="n">epsilon</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">getRelativePermittivity</span><span class="p">()),</span>
        <span class="n">center</span><span class="o">=</span><span class="n">meep</span><span class="o">.</span><span class="n">Vector3</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">getLocation</span><span class="p">()))</span>
    <span class="k">return</span><span class="p">(</span><span class="n">meep_cylinder</span><span class="p">)</span></div>

<div class="viewcode-block" id="Cylinder.createBlenderObject"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Cylinder.createBlenderObject">[docs]</a>  <span class="k">def</span> <span class="nf">createBlenderObject</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">blender_operator</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
    <span class="c1"># Creates an object in blender and returns the created object</span>
    
    <span class="c1"># import necessary packages</span>
    <span class="kn">import</span> <span class="nn">bpy</span>
    <span class="kn">import</span> <span class="nn">numpy</span>
    <span class="kn">from</span> <span class="nn">blender_scripts.modules.GeometryObjects</span> <span class="k">import</span> <span class="n">add_cylinder</span><span class="p">,</span> <span class="n">add_tetra</span><span class="p">,</span> <span class="n">add_block</span>
    <span class="kn">from</span> <span class="nn">blender_scripts.modules.blender_utilities</span> <span class="k">import</span> <span class="n">selectObjects</span>
    
    <span class="c1"># get cursor location for placement</span>
    <span class="n">cursor_location3</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">bpy</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">scene</span><span class="o">.</span><span class="n">cursor_location</span><span class="p">)</span>
    
    <span class="n">A</span><span class="p">,</span><span class="n">B</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">getStartEndPoints</span><span class="p">()</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="n">add_cylinder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;BFDTD-Cylinder&#39;</span><span class="p">,</span> <span class="n">cylinder_radius</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">getOuterRadius</span><span class="p">())</span>
    <span class="k">return</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Cone"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Cone">[docs]</a><span class="k">class</span> <span class="nc">Cone</span><span class="p">(</span><span class="n">Cylinder</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">inner_radius_2</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">outer_radius_2</span> <span class="o">=</span> <span class="mi">1</span>
  
<div class="viewcode-block" id="Cone.setInnerRadius2"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Cone.setInnerRadius2">[docs]</a>  <span class="k">def</span> <span class="nf">setInnerRadius2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inner_radius_2</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">inner_radius_2</span> <span class="o">=</span> <span class="n">inner_radius_2</span>
    <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inner_radius_2</span><span class="p">)</span></div>
<div class="viewcode-block" id="Cone.setOuterRadius2"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Cone.setOuterRadius2">[docs]</a>  <span class="k">def</span> <span class="nf">setOuterRadius2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outer_radius_2</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">outer_radius_2</span> <span class="o">=</span> <span class="n">outer_radius_2</span>
    <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outer_radius_2</span><span class="p">)</span></div>
  
<div class="viewcode-block" id="Cone.getInnerRadius2"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Cone.getInnerRadius2">[docs]</a>  <span class="k">def</span> <span class="nf">getInnerRadius2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inner_radius_2</span><span class="p">)</span></div>
<div class="viewcode-block" id="Cone.getOuterRadius2"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Cone.getOuterRadius2">[docs]</a>  <span class="k">def</span> <span class="nf">getOuterRadius2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outer_radius_2</span><span class="p">)</span></div>

<div class="viewcode-block" id="Cone.getInnerRadius1"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Cone.getInnerRadius1">[docs]</a>  <span class="k">def</span> <span class="nf">getInnerRadius1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getInnerRadius</span><span class="p">())</span></div>
<div class="viewcode-block" id="Cone.getOuterRadius1"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Cone.getOuterRadius1">[docs]</a>  <span class="k">def</span> <span class="nf">getOuterRadius1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">getOuterRadius</span><span class="p">())</span></div></div>

<div class="viewcode-block" id="Rotation"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Rotation">[docs]</a><span class="k">class</span> <span class="nc">Rotation</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
  <span class="c1"># .. todo:: meshing params in case of rotations</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
      <span class="n">name</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
      <span class="n">axis_point</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
      <span class="n">axis_direction</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
      <span class="n">angle_degrees</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
      
    <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;rotation&#39;</span>
    <span class="k">if</span> <span class="n">axis_point</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">axis_point</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">axis_direction</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">axis_direction</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">angle_degrees</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">angle_degrees</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">axis_point</span> <span class="o">=</span> <span class="n">axis_point</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">axis_direction</span> <span class="o">=</span> <span class="n">axis_direction</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">angle_degrees</span> <span class="o">=</span> <span class="n">angle_degrees</span>
    
  <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">ret</span>  <span class="o">=</span> <span class="s1">&#39;name = &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;axis_point = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axis_point</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;axis_direction = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axis_direction</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;angle_degrees = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angle_degrees</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ret</span>
    
<div class="viewcode-block" id="Rotation.read_entry"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Rotation.read_entry">[docs]</a>  <span class="k">def</span> <span class="nf">read_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">entry</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">entry</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">axis_point</span> <span class="o">=</span> <span class="n">float_array</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">axis_direction</span> <span class="o">=</span> <span class="n">float_array</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">3</span><span class="p">:</span><span class="mi">6</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">angle_degrees</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span></div>
    
<div class="viewcode-block" id="Rotation.write_entry"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Rotation.write_entry">[docs]</a>  <span class="k">def</span> <span class="nf">write_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">FILE</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">):</span>
    <span class="c1"># rotation structure. Actually affects previous geometry object in Prof. Railton&#39;s modified BrisFDTD. Not fully implemented yet.</span>
    <span class="c1"># Should be integrated into existing structures using a directional vector anyway, like in MEEP. BrisFDTD hacking required... :)</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;ROTATION **name=&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;{</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%E</span><span class="s2"> **X axis_point</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis_point</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%E</span><span class="s2"> **Y axis_point</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis_point</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%E</span><span class="s2"> **Z axis_point</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis_point</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%E</span><span class="s2"> **X axis_direction</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis_direction</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%E</span><span class="s2"> **Y axis_direction</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis_direction</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%E</span><span class="s2"> **Z axis_direction</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis_direction</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%E</span><span class="s2"> **angle_degrees</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle_degrees</span><span class="p">)</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">FILE</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="Rotation.getRotationMatrix"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.Rotation.getRotationMatrix">[docs]</a>  <span class="k">def</span> <span class="nf">getRotationMatrix</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">rotation_matrix3</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axis_direction</span><span class="p">,</span> <span class="n">deg2rad</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">angle_degrees</span><span class="p">))</span></div></div>

<div class="viewcode-block" id="MeshBox"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.MeshBox">[docs]</a><span class="k">class</span> <span class="nc">MeshBox</span><span class="p">(</span><span class="n">GeometryObject</span><span class="p">):</span>
  <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">  GeometryObject whose only function is to provide a custom &quot;mesh box&quot;.</span>
<span class="sd">  </span>
<span class="sd">  Main attributes are the lists of *MeshParams* objects in X,Y,Z:</span>
<span class="sd">  </span>
<span class="sd">  * xmesh_params</span>
<span class="sd">  * ymesh_params</span>
<span class="sd">  * zmesh_params</span>
<span class="sd">  </span>
<span class="sd">  It also provides a getMeshingParameters() function.</span>
<span class="sd">  </span>
<span class="sd">  .. note:: I might keep this class, just because of rotations for the meshs... Mmh... Or is GeometryObject enough if it gets the MeshParams stuff?</span>
<span class="sd">  .. todo:: should inherit from Block class...</span>
<span class="sd">  &#39;&#39;&#39;</span>
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
    <span class="n">name</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">layer</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">group</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">lower</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">upper</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>

    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;MeshBox: This class is currently broken.&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;mesh_box&#39;</span>
    <span class="k">if</span> <span class="n">layer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">layer</span> <span class="o">=</span> <span class="s1">&#39;mesh_box&#39;</span>
    <span class="k">if</span> <span class="n">group</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">group</span> <span class="o">=</span> <span class="s1">&#39;mesh_box&#39;</span>
    <span class="k">if</span> <span class="n">lower</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">lower</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">upper</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">upper</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="n">GeometryObject</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">layer</span> <span class="o">=</span> <span class="n">layer</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">group</span> <span class="o">=</span> <span class="n">group</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lower</span> <span class="o">=</span> <span class="n">lower</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">upper</span> <span class="o">=</span> <span class="n">upper</span>
    
    <span class="c1"># first mesh object list test case :)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">xmesh_params</span> <span class="o">=</span> <span class="p">[</span><span class="n">MeshingParameters</span><span class="p">(</span><span class="n">lower</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">upper</span><span class="p">[</span><span class="mi">0</span><span class="p">])]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ymesh_params</span> <span class="o">=</span> <span class="p">[</span><span class="n">MeshingParameters</span><span class="p">(</span><span class="n">lower</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">upper</span><span class="p">[</span><span class="mi">1</span><span class="p">])]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">zmesh_params</span> <span class="o">=</span> <span class="p">[</span><span class="n">MeshingParameters</span><span class="p">(</span><span class="n">lower</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">upper</span><span class="p">[</span><span class="mi">2</span><span class="p">])]</span>
  
  <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">ret</span>  <span class="o">=</span> <span class="s1">&#39;name = &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;lower = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lower</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;upper = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">upper</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;xmesh_params:</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">xmesh_params</span><span class="p">:</span>
      <span class="n">ret</span> <span class="o">+=</span> <span class="n">i</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;ymesh_params:</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ymesh_params</span><span class="p">:</span>
      <span class="n">ret</span> <span class="o">+=</span> <span class="n">i</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="s1">&#39;zmesh_params:</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">zmesh_params</span><span class="p">:</span>
      <span class="n">ret</span> <span class="o">+=</span> <span class="n">i</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">ret</span> <span class="o">+=</span> <span class="n">GeometryObject</span><span class="o">.</span><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ret</span>

<div class="viewcode-block" id="MeshBox.getCentro"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.MeshBox.getCentro">[docs]</a>  <span class="k">def</span> <span class="nf">getCentro</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lower</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">upper</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lower</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">upper</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lower</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">upper</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="p">]</span></div>
  
<div class="viewcode-block" id="MeshBox.getMeshingParameters"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.MeshBox.getMeshingParameters">[docs]</a>  <span class="k">def</span> <span class="nf">getMeshingParameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">xvec</span><span class="p">,</span><span class="n">yvec</span><span class="p">,</span><span class="n">zvec</span><span class="p">,</span><span class="n">epsx</span><span class="p">,</span><span class="n">epsy</span><span class="p">,</span><span class="n">epsz</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; .. note:: adapting and leaving this until we have time to rework the automeshing function &#39;&#39;&#39;</span>
    <span class="n">objx</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sort</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">lower</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">upper</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
    <span class="n">objy</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sort</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">lower</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">upper</span><span class="p">[</span><span class="mi">1</span><span class="p">]])</span>
    <span class="n">objz</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sort</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">lower</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">upper</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
    <span class="n">xvec</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">xvec</span><span class="p">,</span><span class="n">objx</span><span class="p">])</span>
    <span class="n">yvec</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">yvec</span><span class="p">,</span><span class="n">objy</span><span class="p">])</span>
    <span class="n">zvec</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">zvec</span><span class="p">,</span><span class="n">objz</span><span class="p">])</span>
    <span class="c1"># .. todo:: Should merge the meshes if there are more than one...</span>
    <span class="n">epsx</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">epsx</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">xmesh_params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">getPermittivityMin</span><span class="p">()])</span>
    <span class="n">epsy</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">epsy</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">ymesh_params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">getPermittivityMin</span><span class="p">()])</span>
    <span class="n">epsz</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">epsz</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">zmesh_params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">getPermittivityMin</span><span class="p">()])</span>
    <span class="k">return</span> <span class="n">xvec</span><span class="p">,</span><span class="n">yvec</span><span class="p">,</span><span class="n">zvec</span><span class="p">,</span><span class="n">epsx</span><span class="p">,</span><span class="n">epsy</span><span class="p">,</span><span class="n">epsz</span></div>
    
<div class="viewcode-block" id="MeshBox.write_entry"><a class="viewcode-back" href="../../bfdtd.html#bfdtd.GeometryObjects.MeshBox.write_entry">[docs]</a>  <span class="k">def</span> <span class="nf">write_entry</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">FILE</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; .. note:: Does nothing for the moment. Could eventually add a nice little comment to the .geo or .inp file. Or we bypass it in the writeGeoFile function. &#39;&#39;&#39;</span>
    <span class="k">return</span></div></div>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
  <span class="k">pass</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">script_inception_public  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2014, Mike Taverne.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.9.
    </div>
  </body>
</html>